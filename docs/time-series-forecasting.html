<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>18 Time Series Forecasting | R for Geospatial Sciences</title>
  <meta name="description" content="Advanced R" />
  <meta name="generator" content="bookdown 0.20.6 and GitBook 2.6.7" />

  <meta property="og:title" content="18 Time Series Forecasting | R for Geospatial Sciences" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Advanced R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="18 Time Series Forecasting | R for Geospatial Sciences" />
  
  <meta name="twitter:description" content="Advanced R" />
  

<meta name="author" content="James Simkins" />


<meta name="date" content="2021-01-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="machine-learning-with-r.html"/>
<link rel="next" href="random-forest-modeling.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
<script src="libs/FlatGeoBuf-3.3.3/fgb.js"></script>
<script src="libs/FlatGeoBuf-3.3.3/flatgeobuf-geojson.min.js"></script>
<script src="libs/chromajs-2.1.0/chroma.min.js"></script>
<link id="merged_coast[maxpred]-1-attachment" rel="attachment" href="libs/merged_coast[maxpred]-0.0.1/merged_coast[maxpred]_layer.fgb"/>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />
<link id="m[name]-1-attachment" rel="attachment" href="libs/m[name]-0.0.1/m[name]_layer.fgb"/>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for Geospatial Sciences</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="r-for-geospatial-sciences.html"><a href="r-for-geospatial-sciences.html"><i class="fa fa-check"></i><b>1</b> R for Geospatial Sciences</a><ul>
<li class="chapter" data-level="1.1" data-path="r-for-geospatial-sciences.html"><a href="r-for-geospatial-sciences.html#welcome"><i class="fa fa-check"></i><b>1.1</b> Welcome</a></li>
<li class="chapter" data-level="1.2" data-path="r-for-geospatial-sciences.html"><a href="r-for-geospatial-sciences.html#course-github"><i class="fa fa-check"></i><b>1.2</b> Course Github</a></li>
<li class="chapter" data-level="1.3" data-path="r-for-geospatial-sciences.html"><a href="r-for-geospatial-sciences.html#syllabus"><i class="fa fa-check"></i><b>1.3</b> Syllabus</a></li>
<li class="chapter" data-level="1.4" data-path="r-for-geospatial-sciences.html"><a href="r-for-geospatial-sciences.html#phase-1"><i class="fa fa-check"></i><b>1.4</b> Phase 1</a></li>
<li class="chapter" data-level="1.5" data-path="r-for-geospatial-sciences.html"><a href="r-for-geospatial-sciences.html#phase-2"><i class="fa fa-check"></i><b>1.5</b> Phase 2</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i><b>2</b> Getting Started with R</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#why-is-there-such-a-buzz-around-r"><i class="fa fa-check"></i><b>2.1</b> Why is there such a buzz around R?</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#reasons-to-love-r"><i class="fa fa-check"></i><b>2.2</b> Reasons to love R</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#downloading-guide"><i class="fa fa-check"></i><b>2.3</b> Downloading Guide</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#rstudio"><i class="fa fa-check"></i><b>2.4</b> Rstudio</a></li>
<li class="chapter" data-level="2.5" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#download-course-datasets"><i class="fa fa-check"></i><b>2.5</b> Download Course Datasets</a></li>
<li class="chapter" data-level="2.6" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#video-examples"><i class="fa fa-check"></i><b>2.6</b> Video Examples</a></li>
<li class="chapter" data-level="2.7" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#getting-familiar-with-rstudio"><i class="fa fa-check"></i><b>2.7</b> Getting familiar with RStudio</a></li>
<li class="chapter" data-level="2.8" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#open-rstudio"><i class="fa fa-check"></i><b>2.8</b> Open RStudio</a></li>
<li class="chapter" data-level="2.9" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#r-studio-layout"><i class="fa fa-check"></i><b>2.9</b> R Studio Layout</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="definitions-rules.html"><a href="definitions-rules.html"><i class="fa fa-check"></i><b>3</b> Definitions &amp; Rules</a><ul>
<li class="chapter" data-level="3.1" data-path="definitions-rules.html"><a href="definitions-rules.html#important-r-programming-definitions"><i class="fa fa-check"></i><b>3.1</b> Important R Programming Definitions</a></li>
<li class="chapter" data-level="3.2" data-path="definitions-rules.html"><a href="definitions-rules.html#rules"><i class="fa fa-check"></i><b>3.2</b> Rules</a></li>
<li class="chapter" data-level="3.3" data-path="definitions-rules.html"><a href="definitions-rules.html#general-recommendations"><i class="fa fa-check"></i><b>3.3</b> General Recommendations</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html"><i class="fa fa-check"></i><b>4</b> R Coding Fundamentals</a><ul>
<li class="chapter" data-level="4.1" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#entering-input"><i class="fa fa-check"></i><b>4.1</b> Entering Input</a></li>
<li class="chapter" data-level="4.2" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#running-code"><i class="fa fa-check"></i><b>4.2</b> Running Code</a></li>
<li class="chapter" data-level="4.3" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#evaluation"><i class="fa fa-check"></i><b>4.3</b> Evaluation</a></li>
<li class="chapter" data-level="4.4" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#r-objects"><i class="fa fa-check"></i><b>4.4</b> R Objects</a></li>
<li class="chapter" data-level="4.5" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#numbers"><i class="fa fa-check"></i><b>4.5</b> Numbers</a></li>
<li class="chapter" data-level="4.6" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#attributes"><i class="fa fa-check"></i><b>4.6</b> Attributes</a></li>
<li class="chapter" data-level="4.7" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#creating-vectors"><i class="fa fa-check"></i><b>4.7</b> Creating Vectors</a></li>
<li class="chapter" data-level="4.8" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#mixing-objects"><i class="fa fa-check"></i><b>4.8</b> Mixing Objects</a></li>
<li class="chapter" data-level="4.9" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#explicit-coercion"><i class="fa fa-check"></i><b>4.9</b> Explicit Coercion</a></li>
<li class="chapter" data-level="4.10" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#matrices"><i class="fa fa-check"></i><b>4.10</b> Matrices</a></li>
<li class="chapter" data-level="4.11" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#lists"><i class="fa fa-check"></i><b>4.11</b> Lists</a></li>
<li class="chapter" data-level="4.12" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#factors"><i class="fa fa-check"></i><b>4.12</b> Factors</a></li>
<li class="chapter" data-level="4.13" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#missing-values"><i class="fa fa-check"></i><b>4.13</b> Missing Values</a></li>
<li class="chapter" data-level="4.14" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#data-frames"><i class="fa fa-check"></i><b>4.14</b> Data Frames</a></li>
<li class="chapter" data-level="4.15" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#names"><i class="fa fa-check"></i><b>4.15</b> Names</a></li>
<li class="chapter" data-level="4.16" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#summary"><i class="fa fa-check"></i><b>4.16</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="basic-r-scripts.html"><a href="basic-r-scripts.html"><i class="fa fa-check"></i><b>5</b> Basic R Scripts</a><ul>
<li class="chapter" data-level="5.1" data-path="basic-r-scripts.html"><a href="basic-r-scripts.html#global-carbon-dioxide-concentrations"><i class="fa fa-check"></i><b>5.1</b> Global Carbon-Dioxide Concentrations</a><ul>
<li class="chapter" data-level="5.1.1" data-path="basic-r-scripts.html"><a href="basic-r-scripts.html#saving-your-plot"><i class="fa fa-check"></i><b>5.1.1</b> Saving your plot</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="basic-r-scripts.html"><a href="basic-r-scripts.html#cars---motor-trends-magazine-data"><i class="fa fa-check"></i><b>5.2</b> Cars - Motor Trends Magazine Data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="scientific-r-scripts.html"><a href="scientific-r-scripts.html"><i class="fa fa-check"></i><b>6</b> Scientific R Scripts</a><ul>
<li class="chapter" data-level="6.1" data-path="scientific-r-scripts.html"><a href="scientific-r-scripts.html#script-breakdown"><i class="fa fa-check"></i><b>6.1</b> Script Breakdown</a></li>
<li class="chapter" data-level="6.2" data-path="scientific-r-scripts.html"><a href="scientific-r-scripts.html#in-class-exercise"><i class="fa fa-check"></i><b>6.2</b> In Class Exercise</a><ul>
<li class="chapter" data-level="6.2.1" data-path="scientific-r-scripts.html"><a href="scientific-r-scripts.html#further-explanation-of-datatypes"><i class="fa fa-check"></i><b>6.2.1</b> Further Explanation of DataTypes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="time-series-data.html"><a href="time-series-data.html"><i class="fa fa-check"></i><b>7</b> Time Series Data</a><ul>
<li class="chapter" data-level="7.1" data-path="time-series-data.html"><a href="time-series-data.html#for-loops"><i class="fa fa-check"></i><b>7.1</b> For Loops</a></li>
<li class="chapter" data-level="7.2" data-path="time-series-data.html"><a href="time-series-data.html#deos-data"><i class="fa fa-check"></i><b>7.2</b> DEOS Data</a></li>
<li class="chapter" data-level="7.3" data-path="time-series-data.html"><a href="time-series-data.html#assignment"><i class="fa fa-check"></i><b>7.3</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="raster-visualization.html"><a href="raster-visualization.html"><i class="fa fa-check"></i><b>8</b> Raster Visualization</a><ul>
<li class="chapter" data-level="8.1" data-path="raster-visualization.html"><a href="raster-visualization.html#paste0"><i class="fa fa-check"></i><b>8.1</b> <code>Paste0()</code></a></li>
<li class="chapter" data-level="8.2" data-path="raster-visualization.html"><a href="raster-visualization.html#rasters"><i class="fa fa-check"></i><b>8.2</b> Rasters</a></li>
<li class="chapter" data-level="8.3" data-path="raster-visualization.html"><a href="raster-visualization.html#assignment-1"><i class="fa fa-check"></i><b>8.3</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="reprojecting-writing-rasters.html"><a href="reprojecting-writing-rasters.html"><i class="fa fa-check"></i><b>9</b> Reprojecting &amp; Writing Rasters</a><ul>
<li class="chapter" data-level="9.1" data-path="reprojecting-writing-rasters.html"><a href="reprojecting-writing-rasters.html#indexing-data"><i class="fa fa-check"></i><b>9.1</b> Indexing Data</a></li>
<li class="chapter" data-level="9.2" data-path="reprojecting-writing-rasters.html"><a href="reprojecting-writing-rasters.html#resampling-and-reprojecting"><i class="fa fa-check"></i><b>9.2</b> Resampling and Reprojecting</a></li>
<li class="chapter" data-level="9.3" data-path="reprojecting-writing-rasters.html"><a href="reprojecting-writing-rasters.html#pngs"><i class="fa fa-check"></i><b>9.3</b> PNGs</a></li>
<li class="chapter" data-level="9.4" data-path="reprojecting-writing-rasters.html"><a href="reprojecting-writing-rasters.html#writing-rasters"><i class="fa fa-check"></i><b>9.4</b> Writing Rasters</a></li>
<li class="chapter" data-level="9.5" data-path="reprojecting-writing-rasters.html"><a href="reprojecting-writing-rasters.html#assignment-2"><i class="fa fa-check"></i><b>9.5</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="plot-customization.html"><a href="plot-customization.html"><i class="fa fa-check"></i><b>10</b> Plot Customization</a><ul>
<li class="chapter" data-level="10.1" data-path="plot-customization.html"><a href="plot-customization.html#expanding-on-basic-plots-in-r"><i class="fa fa-check"></i><b>10.1</b> Expanding on Basic Plots in R</a><ul>
<li class="chapter" data-level="10.1.1" data-path="plot-customization.html"><a href="plot-customization.html#adding-to-a-plot"><i class="fa fa-check"></i><b>10.1.1</b> Adding to a Plot</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="plot-customization.html"><a href="plot-customization.html#barplots-boxplots-pie-charts"><i class="fa fa-check"></i><b>10.2</b> Barplots, Boxplots, Pie Charts</a><ul>
<li class="chapter" data-level="10.2.1" data-path="plot-customization.html"><a href="plot-customization.html#combining-plots"><i class="fa fa-check"></i><b>10.2.1</b> Combining Plots</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="plot-customization.html"><a href="plot-customization.html#tree-data"><i class="fa fa-check"></i><b>10.3</b> Tree Data</a><ul>
<li class="chapter" data-level="10.3.1" data-path="plot-customization.html"><a href="plot-customization.html#loading-the-dataset"><i class="fa fa-check"></i><b>10.3.1</b> Loading the Dataset</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="plot-customization.html"><a href="plot-customization.html#assignment-3"><i class="fa fa-check"></i><b>10.4</b> Assignment:</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="basic-statistics.html"><a href="basic-statistics.html"><i class="fa fa-check"></i><b>11</b> Basic Statistics</a><ul>
<li class="chapter" data-level="11.1" data-path="basic-statistics.html"><a href="basic-statistics.html#statistical-function-dictionary"><i class="fa fa-check"></i><b>11.1</b> Statistical Function Dictionary</a></li>
<li class="chapter" data-level="11.2" data-path="basic-statistics.html"><a href="basic-statistics.html#basic-statistics-in-r"><i class="fa fa-check"></i><b>11.2</b> Basic Statistics in R</a><ul>
<li class="chapter" data-level="11.2.1" data-path="basic-statistics.html"><a href="basic-statistics.html#load-willow-creek-data"><i class="fa fa-check"></i><b>11.2.1</b> Load Willow Creek data</a></li>
<li class="chapter" data-level="11.2.2" data-path="basic-statistics.html"><a href="basic-statistics.html#subsetting-data"><i class="fa fa-check"></i><b>11.2.2</b> Subsetting Data</a></li>
<li class="chapter" data-level="11.2.3" data-path="basic-statistics.html"><a href="basic-statistics.html#trends-and-distributions"><i class="fa fa-check"></i><b>11.2.3</b> Trends and Distributions</a></li>
<li class="chapter" data-level="11.2.4" data-path="basic-statistics.html"><a href="basic-statistics.html#finding-a-best-fit-distribution"><i class="fa fa-check"></i><b>11.2.4</b> Finding a Best-Fit Distribution</a></li>
<li class="chapter" data-level="11.2.5" data-path="basic-statistics.html"><a href="basic-statistics.html#correlation-plots"><i class="fa fa-check"></i><b>11.2.5</b> Correlation Plots</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="basic-statistics.html"><a href="basic-statistics.html#assignment-4"><i class="fa fa-check"></i><b>11.3</b> Assignment</a><ul>
<li class="chapter" data-level="11.3.1" data-path="basic-statistics.html"><a href="basic-statistics.html#extra-credit---2-points"><i class="fa fa-check"></i><b>11.3.1</b> Extra Credit - 2 points</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html"><i class="fa fa-check"></i><b>12</b> Plotting with <code>ggplot2</code></a><ul>
<li class="chapter" data-level="12.1" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html#ggplot2-with-willow-creek-meteorological-data"><i class="fa fa-check"></i><b>12.1</b> ggplot2 with Willow Creek Meteorological Data</a></li>
<li class="chapter" data-level="12.2" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html#assignment-5"><i class="fa fa-check"></i><b>12.2</b> Assignment:</a></li>
<li class="chapter" data-level="12.3" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html#extra-credit---2-points-1"><i class="fa fa-check"></i><b>12.3</b> Extra Credit - 2 Points</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="spatial-plots-with-ggplot2.html"><a href="spatial-plots-with-ggplot2.html"><i class="fa fa-check"></i><b>13</b> Spatial Plots with <code>ggplot2</code></a><ul>
<li class="chapter" data-level="13.1" data-path="spatial-plots-with-ggplot2.html"><a href="spatial-plots-with-ggplot2.html#simple-features"><i class="fa fa-check"></i><b>13.1</b> Simple Features</a></li>
<li class="chapter" data-level="13.2" data-path="spatial-plots-with-ggplot2.html"><a href="spatial-plots-with-ggplot2.html#sea-surface-temperature-ggplot"><i class="fa fa-check"></i><b>13.2</b> Sea Surface Temperature ggplot</a></li>
<li class="chapter" data-level="13.3" data-path="spatial-plots-with-ggplot2.html"><a href="spatial-plots-with-ggplot2.html#r-color-brewer-palettes"><i class="fa fa-check"></i><b>13.3</b> R Color Brewer Palettes</a><ul>
<li class="chapter" data-level="13.3.1" data-path="spatial-plots-with-ggplot2.html"><a href="spatial-plots-with-ggplot2.html#multi-plot-ggplot"><i class="fa fa-check"></i><b>13.3.1</b> Multi Plot ggplot</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="spatial-plots-with-ggplot2.html"><a href="spatial-plots-with-ggplot2.html#assignment-6"><i class="fa fa-check"></i><b>13.4</b> Assignment</a><ul>
<li class="chapter" data-level="13.4.1" data-path="spatial-plots-with-ggplot2.html"><a href="spatial-plots-with-ggplot2.html#extra-credit---2-points-2"><i class="fa fa-check"></i><b>13.4.1</b> Extra Credit - 2 Points</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="shapefiles.html"><a href="shapefiles.html"><i class="fa fa-check"></i><b>14</b> Shapefiles</a><ul>
<li class="chapter" data-level="14.1" data-path="shapefiles.html"><a href="shapefiles.html#reading-in-shapefiles"><i class="fa fa-check"></i><b>14.1</b> Reading in Shapefiles</a></li>
<li class="chapter" data-level="14.2" data-path="shapefiles.html"><a href="shapefiles.html#combining-shapefiles-with-data"><i class="fa fa-check"></i><b>14.2</b> Combining Shapefiles with Data</a></li>
<li class="chapter" data-level="14.3" data-path="shapefiles.html"><a href="shapefiles.html#visualizing-the-shapefiles-data"><i class="fa fa-check"></i><b>14.3</b> Visualizing the Shapefiles &amp; Data</a></li>
<li class="chapter" data-level="14.4" data-path="shapefiles.html"><a href="shapefiles.html#saving-a-shapefile"><i class="fa fa-check"></i><b>14.4</b> Saving a shapefile</a></li>
<li class="chapter" data-level="14.5" data-path="shapefiles.html"><a href="shapefiles.html#assignment-7"><i class="fa fa-check"></i><b>14.5</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="remote-data-extraction.html"><a href="remote-data-extraction.html"><i class="fa fa-check"></i><b>15</b> Remote Data Extraction</a><ul>
<li class="chapter" data-level="15.1" data-path="remote-data-extraction.html"><a href="remote-data-extraction.html#thredds"><i class="fa fa-check"></i><b>15.1</b> THREDDS</a></li>
<li class="chapter" data-level="15.2" data-path="remote-data-extraction.html"><a href="remote-data-extraction.html#erddap"><i class="fa fa-check"></i><b>15.2</b> ERDDAP</a><ul>
<li class="chapter" data-level="15.2.1" data-path="remote-data-extraction.html"><a href="remote-data-extraction.html#finding-the-data-you-want"><i class="fa fa-check"></i><b>15.2.1</b> Finding the Data You Want</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="remote-data-extraction.html"><a href="remote-data-extraction.html#assignment-8"><i class="fa fa-check"></i><b>15.3</b> Assignment</a><ul>
<li class="chapter" data-level="15.3.1" data-path="remote-data-extraction.html"><a href="remote-data-extraction.html#extra-credit---2-points-3"><i class="fa fa-check"></i><b>15.3.1</b> Extra Credit - 2 Points</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="functions-and-code-presentation.html"><a href="functions-and-code-presentation.html"><i class="fa fa-check"></i><b>16</b> Functions and Code Presentation</a><ul>
<li class="chapter" data-level="16.1" data-path="functions-and-code-presentation.html"><a href="functions-and-code-presentation.html#functions"><i class="fa fa-check"></i><b>16.1</b> Functions</a></li>
<li class="chapter" data-level="16.2" data-path="functions-and-code-presentation.html"><a href="functions-and-code-presentation.html#netcdf-processing-function"><i class="fa fa-check"></i><b>16.2</b> NetCDF Processing Function</a></li>
<li class="chapter" data-level="16.3" data-path="functions-and-code-presentation.html"><a href="functions-and-code-presentation.html#functions-in-for-loops"><i class="fa fa-check"></i><b>16.3</b> Functions in For Loops</a></li>
<li class="chapter" data-level="16.4" data-path="functions-and-code-presentation.html"><a href="functions-and-code-presentation.html#rmarkdown"><i class="fa fa-check"></i><b>16.4</b> RMarkdown</a></li>
<li class="chapter" data-level="16.5" data-path="functions-and-code-presentation.html"><a href="functions-and-code-presentation.html#assignment-9"><i class="fa fa-check"></i><b>16.5</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="machine-learning-with-r.html"><a href="machine-learning-with-r.html"><i class="fa fa-check"></i><b>17</b> Machine Learning with R</a><ul>
<li class="chapter" data-level="17.1" data-path="machine-learning-with-r.html"><a href="machine-learning-with-r.html#machine-learning-terms"><i class="fa fa-check"></i><b>17.1</b> Machine Learning Terms</a></li>
<li class="chapter" data-level="17.2" data-path="machine-learning-with-r.html"><a href="machine-learning-with-r.html#classical-machine-learning"><i class="fa fa-check"></i><b>17.2</b> Classical Machine Learning</a><ul>
<li class="chapter" data-level="17.2.1" data-path="machine-learning-with-r.html"><a href="machine-learning-with-r.html#supervised-learning"><i class="fa fa-check"></i><b>17.2.1</b> Supervised Learning</a></li>
<li class="chapter" data-level="17.2.2" data-path="machine-learning-with-r.html"><a href="machine-learning-with-r.html#unsupervised-learning"><i class="fa fa-check"></i><b>17.2.2</b> Unsupervised Learning</a></li>
<li class="chapter" data-level="17.2.3" data-path="machine-learning-with-r.html"><a href="machine-learning-with-r.html#neural-networks"><i class="fa fa-check"></i><b>17.2.3</b> Neural Networks</a></li>
<li class="chapter" data-level="17.2.4" data-path="machine-learning-with-r.html"><a href="machine-learning-with-r.html#reinforcement-learning"><i class="fa fa-check"></i><b>17.2.4</b> Reinforcement Learning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html"><i class="fa fa-check"></i><b>18</b> Time Series Forecasting</a><ul>
<li class="chapter" data-level="18.1" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#load-the-packages-and-data"><i class="fa fa-check"></i><b>18.1</b> Load the Packages and Data</a></li>
<li class="chapter" data-level="18.2" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#aggregate-data"><i class="fa fa-check"></i><b>18.2</b> Aggregate Data</a></li>
<li class="chapter" data-level="18.3" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#prepping-the-model"><i class="fa fa-check"></i><b>18.3</b> Prepping the Model</a></li>
<li class="chapter" data-level="18.4" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#running-the-model"><i class="fa fa-check"></i><b>18.4</b> Running the Model</a></li>
<li class="chapter" data-level="18.5" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#validation-and-accuracy"><i class="fa fa-check"></i><b>18.5</b> Validation and Accuracy</a></li>
<li class="chapter" data-level="18.6" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#future-forecasting"><i class="fa fa-check"></i><b>18.6</b> Future Forecasting</a></li>
<li class="chapter" data-level="18.7" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#assignment-10"><i class="fa fa-check"></i><b>18.7</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html"><i class="fa fa-check"></i><b>19</b> Random Forest Modeling</a><ul>
<li class="chapter" data-level="19.1" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#prepare-the-data"><i class="fa fa-check"></i><b>19.1</b> Prepare the Data</a></li>
<li class="chapter" data-level="19.2" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#dimensionality-reduction"><i class="fa fa-check"></i><b>19.2</b> Dimensionality Reduction</a><ul>
<li class="chapter" data-level="19.2.1" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#principal-component-analysis"><i class="fa fa-check"></i><b>19.2.1</b> Principal Component Analysis</a></li>
<li class="chapter" data-level="19.2.2" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#t-sne-dimensionality-reduction"><i class="fa fa-check"></i><b>19.2.2</b> t-SNE Dimensionality Reduction</a></li>
<li class="chapter" data-level="19.2.3" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#multidimensional-scaling"><i class="fa fa-check"></i><b>19.2.3</b> Multidimensional Scaling</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#random-forests"><i class="fa fa-check"></i><b>19.3</b> Random Forests</a><ul>
<li class="chapter" data-level="19.3.1" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#decision-trees"><i class="fa fa-check"></i><b>19.3.1</b> Decision Trees</a></li>
<li class="chapter" data-level="19.3.2" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#data-partition"><i class="fa fa-check"></i><b>19.3.2</b> Data Partition</a></li>
<li class="chapter" data-level="19.3.3" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#training-the-model"><i class="fa fa-check"></i><b>19.3.3</b> Training the Model</a></li>
<li class="chapter" data-level="19.3.4" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#testing-the-model"><i class="fa fa-check"></i><b>19.3.4</b> Testing the Model</a></li>
<li class="chapter" data-level="19.3.5" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#hyperparameter-tuning"><i class="fa fa-check"></i><b>19.3.5</b> Hyperparameter Tuning</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#assignment-11"><i class="fa fa-check"></i><b>19.4</b> Assignment</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/jsimkins2" target="blank">James Simkins</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Geospatial Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="time-series-forecasting" class="section level1">
<h1><span class="header-section-number">18</span> Time Series Forecasting</h1>
<p><img src="images/temp_forecast.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Time series forecasting is widely used in sciences with the intended purpose of predicting the future based on present data. This type of machine learning technique has been used for weather forecasting, glacier melting outlooks, and carbon dioxide concentration predictions. In this tutorial, we will use the Willow Creek Weather Datasets and build an Air Temperature Forecast using Linear Regression Modeling. The goal of this exercise is to build a linear regression model using existing training data to accurately predict existing testing data. This is an isolated tutorial that <strong>does not</strong> account for other variables (precipitation, shortwave radiation, etc.) that may have an influence on Air Temperature. While it may not serve as the best predictive model for air temperature, it serves as a first step in linear regression modeling and machine learning.</p>
<div id="load-the-packages-and-data" class="section level2">
<h2><span class="header-section-number">18.1</span> Load the Packages and Data</h2>
<p>Let’s use the <code>read.wcr</code> function that we previously created to load in our dataset.</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb510-1" data-line-number="1"><span class="kw">library</span>(ncdf4)</a>
<a class="sourceLine" id="cb510-2" data-line-number="2">read.wcr =<span class="st"> </span><span class="cf">function</span>(fname) {</a>
<a class="sourceLine" id="cb510-3" data-line-number="3">  fullname =<span class="st"> </span><span class="kw">strsplit</span>(fname, <span class="st">&quot;/&quot;</span>)</a>
<a class="sourceLine" id="cb510-4" data-line-number="4">  dataset_str =<span class="st"> </span>fullname[[<span class="dv">1</span>]][<span class="kw">length</span>(fullname[[<span class="dv">1</span>]])]</a>
<a class="sourceLine" id="cb510-5" data-line-number="5">  datname =<span class="st"> </span><span class="kw">strsplit</span>(dataset_str, <span class="st">&quot;_&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb510-6" data-line-number="6">  data.year =<span class="st"> </span><span class="kw">substr</span>(dataset_str, <span class="kw">nchar</span>(dataset_str)<span class="op">-</span><span class="dv">6</span>, <span class="kw">nchar</span>(dataset_str)<span class="op">-</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb510-7" data-line-number="7">  data.date =<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span><span class="kw">as.POSIXct</span>(<span class="kw">paste0</span>(data.year,<span class="st">&quot;-1-1 0:00&quot;</span>, <span class="dt">tz=</span><span class="st">&quot;UTC&quot;</span>)),<span class="dt">to=</span><span class="kw">as.POSIXct</span>(<span class="kw">paste0</span>(data.year,<span class="st">&quot;-12-31 23:00&quot;</span>, <span class="dt">tz=</span><span class="st">&quot;UTC&quot;</span>)),<span class="dt">by=</span><span class="st">&quot;hour&quot;</span>)</a>
<a class="sourceLine" id="cb510-8" data-line-number="8">  vars.info &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">CF.name =</span> <span class="kw">c</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;air_temperature&quot;</span>, <span class="st">&quot;precipitation_flux&quot;</span>, <span class="st">&quot;surface_downwelling_shortwave_flux_in_air&quot;</span>,</a>
<a class="sourceLine" id="cb510-9" data-line-number="9">                                      <span class="st">&quot;specific_humidity&quot;</span>, <span class="st">&quot;surface_downwelling_longwave_flux_in_air&quot;</span>, <span class="st">&quot;air_pressure&quot;</span>,</a>
<a class="sourceLine" id="cb510-10" data-line-number="10">                                      <span class="st">&quot;eastward_wind&quot;</span>, <span class="st">&quot;northward_wind&quot;</span>, <span class="st">&quot;wind_speed&quot;</span>))</a>
<a class="sourceLine" id="cb510-11" data-line-number="11">  df &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb510-12" data-line-number="12">  tem &lt;-<span class="st"> </span>ncdf4<span class="op">::</span><span class="kw">nc_open</span>(fname)</a>
<a class="sourceLine" id="cb510-13" data-line-number="13">  dim &lt;-<span class="st"> </span>tem<span class="op">$</span>dim</a>
<a class="sourceLine" id="cb510-14" data-line-number="14">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="kw">seq_along</span>(vars.info<span class="op">$</span>CF.name)) {</a>
<a class="sourceLine" id="cb510-15" data-line-number="15">    <span class="cf">if</span> (<span class="kw">exists</span>(<span class="kw">as.character</span>(vars.info<span class="op">$</span>CF.name[j]), tem<span class="op">$</span>var)) {</a>
<a class="sourceLine" id="cb510-16" data-line-number="16">      df[[j]] &lt;-<span class="st"> </span>ncdf4<span class="op">::</span><span class="kw">ncvar_get</span>(tem, <span class="kw">as.character</span>(vars.info<span class="op">$</span>CF.name[j]))</a>
<a class="sourceLine" id="cb510-17" data-line-number="17">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb510-18" data-line-number="18">      df[[j]] =<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb510-19" data-line-number="19">    }</a>
<a class="sourceLine" id="cb510-20" data-line-number="20">  }</a>
<a class="sourceLine" id="cb510-21" data-line-number="21">  <span class="kw">names</span>(df) &lt;-<span class="st"> </span>vars.info<span class="op">$</span>CF.name</a>
<a class="sourceLine" id="cb510-22" data-line-number="22">  df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(df)</a>
<a class="sourceLine" id="cb510-23" data-line-number="23">  <span class="kw">nc_close</span>(tem)</a>
<a class="sourceLine" id="cb510-24" data-line-number="24">  <span class="cf">if</span>(<span class="kw">all</span>(<span class="kw">is.na</span>(df<span class="op">$</span>date))){</a>
<a class="sourceLine" id="cb510-25" data-line-number="25">    df<span class="op">$</span>date =<span class="st"> </span>data.date</a>
<a class="sourceLine" id="cb510-26" data-line-number="26">  }</a>
<a class="sourceLine" id="cb510-27" data-line-number="27">  <span class="kw">return</span>(df)</a>
<a class="sourceLine" id="cb510-28" data-line-number="28">}</a></code></pre></div>
<p>Now, let’s throw the <code>read.wcr</code> function into a loop so we can read in the data for each year.</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb511-1" data-line-number="1"><span class="co"># create a sequence of years for the years we have data</span></a>
<a class="sourceLine" id="cb511-2" data-line-number="2">yearSeq =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2010</span>,<span class="dv">2012</span>)</a>
<a class="sourceLine" id="cb511-3" data-line-number="3"></a>
<a class="sourceLine" id="cb511-4" data-line-number="4"><span class="co"># begin the for loop to open each year of data</span></a>
<a class="sourceLine" id="cb511-5" data-line-number="5"><span class="cf">for</span> (y <span class="cf">in</span> yearSeq){</a>
<a class="sourceLine" id="cb511-6" data-line-number="6">  <span class="co"># use our read.wcr() function and paste in the filename that changes for each year of data</span></a>
<a class="sourceLine" id="cb511-7" data-line-number="7">  tem_df =<span class="st"> </span><span class="kw">read.wcr</span>(<span class="dt">fname =</span> <span class="kw">paste0</span>(<span class="st">&quot;~/Documents/Github/geog473-673/datasets/WCr_1hr.&quot;</span>,y,<span class="st">&quot;.nc&quot;</span>))</a>
<a class="sourceLine" id="cb511-8" data-line-number="8">  <span class="co"># != means DOES NOT EQUAL. This statement reads as - if y DOES NOT EQUAL the first year in yearSeq, proceed to use rbind</span></a>
<a class="sourceLine" id="cb511-9" data-line-number="9">  <span class="co"># otherwise, if y is indeed the first year in yearSeq, we need to initialize wcr_df BEFORE we overwrite tem_df</span></a>
<a class="sourceLine" id="cb511-10" data-line-number="10">  <span class="cf">if</span> (y <span class="op">!=</span><span class="st"> </span>yearSeq[<span class="dv">1</span>]){</a>
<a class="sourceLine" id="cb511-11" data-line-number="11">    wcr_df =<span class="st"> </span><span class="kw">rbind</span>(wcr_df, tem_df)</a>
<a class="sourceLine" id="cb511-12" data-line-number="12">  } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb511-13" data-line-number="13">    wcr_df =<span class="st"> </span>tem_df</a>
<a class="sourceLine" id="cb511-14" data-line-number="14">  }</a>
<a class="sourceLine" id="cb511-15" data-line-number="15">}</a>
<a class="sourceLine" id="cb511-16" data-line-number="16"></a>
<a class="sourceLine" id="cb511-17" data-line-number="17"><span class="kw">length</span>(wcr_df<span class="op">$</span>date)</a></code></pre></div>
<pre><code>## [1] 26304</code></pre>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb513-1" data-line-number="1"><span class="kw">head</span>(wcr_df)</a></code></pre></div>
<pre><code>##                  date air_temperature precipitation_flux
## 1 2010-01-01 00:00:00        260.1135                  0
## 2 2010-01-01 01:00:00        260.0315                  0
## 3 2010-01-01 02:00:00        259.9805                  0
## 4 2010-01-01 03:00:00        259.9005                  0
## 5 2010-01-01 04:00:00        259.7585                  0
## 6 2010-01-01 05:00:00        259.6825                  0
##   surface_downwelling_shortwave_flux_in_air specific_humidity
## 1                                         0       0.001176792
## 2                                         0       0.001170627
## 3                                         0       0.001167514
## 4                                         0       0.001160727
## 5                                         0       0.001142952
## 6                                         0       0.001133232
##   surface_downwelling_longwave_flux_in_air air_pressure eastward_wind
## 1                                 237.6100      95704.5      1.522976
## 2                                 241.6900      95735.5      1.624952
## 3                                 240.3500      95765.5      1.696362
## 4                                 240.9325      95795.5      1.493329
## 5                                 247.3875      95824.5      1.921457
## 6                                 246.5075      95853.0      1.963118
##   northward_wind wind_speed
## 1      -1.462524         NA
## 2      -1.563508         NA
## 3      -1.553177         NA
## 4      -1.702995         NA
## 5      -1.460475         NA
## 6      -1.667144         NA</code></pre>
<p>Our data has been read in. Let’s convert the Air Temperature units from degrees Kelvin to degrees Fahrenheit. Then, let’s plot our time series.</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb515-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb515-2" data-line-number="2"><span class="kw">library</span>(lubridate)</a>
<a class="sourceLine" id="cb515-3" data-line-number="3"></a>
<a class="sourceLine" id="cb515-4" data-line-number="4"><span class="co"># convert the data to Fahrenheit</span></a>
<a class="sourceLine" id="cb515-5" data-line-number="5">wcr_df<span class="op">$</span>air_temperature =<span class="st"> </span>(wcr_df<span class="op">$</span>air_temperature <span class="op">-</span><span class="st"> </span><span class="fl">273.15</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">9</span><span class="op">/</span><span class="dv">5</span>) <span class="op">+</span><span class="st"> </span><span class="dv">32</span></a>
<a class="sourceLine" id="cb515-6" data-line-number="6"></a>
<a class="sourceLine" id="cb515-7" data-line-number="7"><span class="kw">ggplot</span>(<span class="dt">data =</span> wcr_df, <span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> air_temperature)) <span class="op">+</span></a>
<a class="sourceLine" id="cb515-8" data-line-number="8"><span class="st">    </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;2010-01-01&quot;</span>),</a>
<a class="sourceLine" id="cb515-9" data-line-number="9">              <span class="dt">xmax =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;2012-06-01&quot;</span>),</a>
<a class="sourceLine" id="cb515-10" data-line-number="10">              <span class="dt">ymin =</span> <span class="dv">-10</span>, <span class="dt">ymax =</span> <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb515-11" data-line-number="11">              <span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb515-12" data-line-number="12"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;2011-01-01&quot;</span>) , <span class="dt">y =</span> <span class="dv">80</span>,</a>
<a class="sourceLine" id="cb515-13" data-line-number="13">             <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Train Region&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb515-14" data-line-number="14"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;2012-12-01&quot;</span>), <span class="dt">y =</span> <span class="dv">80</span>,</a>
<a class="sourceLine" id="cb515-15" data-line-number="15">             <span class="dt">color =</span> <span class="st">&quot;coral&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Test Region&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb515-16" data-line-number="16"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb515-17" data-line-number="17"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Willow Creek Hourly Air Temperature - 2010-2013&quot;</span>,<span class="dt">y =</span> <span class="st">&quot;Air Temperature (F)&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="R_Geospatial_Sciences_files/figure-html/unnamed-chunk-206-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="aggregate-data" class="section level2">
<h2><span class="header-section-number">18.2</span> Aggregate Data</h2>
<p>Let’s <em>aggregate</em> our dataset from an hourly resolution to a <strong>daily resolution</strong>. This can be done using the <code>xts</code> (a time series library) library which has a convenient function called <code>apply.daily()</code> that averages the default resolution data to a daily resolution. This will enhance speed but also decrease accuracy as we are removing data. In real practice and with proper computer resources we would rather stick with our original hourly resolution.</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb516-1" data-line-number="1"><span class="kw">library</span>(xts)</a>
<a class="sourceLine" id="cb516-2" data-line-number="2"><span class="kw">library</span>(zoo)</a>
<a class="sourceLine" id="cb516-3" data-line-number="3"><span class="co"># create time series data frame based on our datetime </span></a>
<a class="sourceLine" id="cb516-4" data-line-number="4">xt =<span class="st"> </span><span class="kw">xts</span>(wcr_df, <span class="dt">order.by =</span> wcr_df<span class="op">$</span>date)</a>
<a class="sourceLine" id="cb516-5" data-line-number="5"><span class="co"># aggregate to daily resolution</span></a>
<a class="sourceLine" id="cb516-6" data-line-number="6">daily =<span class="st"> </span>xts<span class="op">::</span><span class="kw">apply.daily</span>(xt,mean)</a>
<a class="sourceLine" id="cb516-7" data-line-number="7"><span class="co"># recreate the date variable which has been deemed as the index of our daily dataframe - while it is the index, it&#39;s easier to use if it&#39;s a variable.</span></a>
<a class="sourceLine" id="cb516-8" data-line-number="8">daily =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">date=</span><span class="kw">index</span>(daily), <span class="kw">coredata</span>(daily))</a>
<a class="sourceLine" id="cb516-9" data-line-number="9"><span class="co"># remove artifact of daily aggregation</span></a>
<a class="sourceLine" id="cb516-10" data-line-number="10">daily<span class="op">$</span>date<span class="fl">.1</span> =<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb516-11" data-line-number="11"><span class="co"># plot the new daily air temperature</span></a>
<a class="sourceLine" id="cb516-12" data-line-number="12"><span class="kw">ggplot</span>(<span class="dt">data =</span> daily, <span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> air_temperature)) <span class="op">+</span></a>
<a class="sourceLine" id="cb516-13" data-line-number="13"><span class="st">    </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;2010-01-01&quot;</span>),</a>
<a class="sourceLine" id="cb516-14" data-line-number="14">              <span class="dt">xmax =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;2012-06-01&quot;</span>),</a>
<a class="sourceLine" id="cb516-15" data-line-number="15">              <span class="dt">ymin =</span> <span class="dv">-10</span>, <span class="dt">ymax =</span> <span class="dv">85</span>,</a>
<a class="sourceLine" id="cb516-16" data-line-number="16">              <span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb516-17" data-line-number="17"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;2011-01-01&quot;</span>) , <span class="dt">y =</span> <span class="dv">70</span>,</a>
<a class="sourceLine" id="cb516-18" data-line-number="18">             <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Train Region&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb516-19" data-line-number="19"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;2012-12-01&quot;</span>), <span class="dt">y =</span> <span class="dv">70</span>,</a>
<a class="sourceLine" id="cb516-20" data-line-number="20">             <span class="dt">color =</span> <span class="st">&quot;coral&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Test Region&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb516-21" data-line-number="21"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb516-22" data-line-number="22"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Willow Creek Daily Air Temperature - 2010-2013&quot;</span>,<span class="dt">y =</span> <span class="st">&quot;Air Temperature (F)&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="R_Geospatial_Sciences_files/figure-html/unnamed-chunk-207-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="prepping-the-model" class="section level2">
<h2><span class="header-section-number">18.3</span> Prepping the Model</h2>
<p>Now that we have our data in daily resolution, we can split our dataset into 2; a test dataset, and a train dataset. When we build a linear regression model for a time series dataset, we select a training period and a testing period. For our case, we’re going to train the dataset with data from 2010-01-01 to 2012-05-31. In other words, we’re using 5/6ths of our dataset to train the model. Then, we’ll use the remaining 1/6th (2012-06-01 to 2013-01-01) to test the model to see how well it predicts the temperature using linear regression.</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb517-1" data-line-number="1">train =<span class="st"> </span>daily[<span class="dv">1</span><span class="op">:</span><span class="kw">which</span>(daily<span class="op">$</span>date <span class="op">==</span><span class="st"> </span><span class="kw">as.POSIXct</span>(<span class="st">&quot;2012-05-31 23:00:00 EDT&quot;</span>)),]</a>
<a class="sourceLine" id="cb517-2" data-line-number="2">test =<span class="st"> </span>daily[<span class="kw">which</span>(daily<span class="op">$</span>date <span class="op">==</span><span class="st"> </span><span class="kw">as.POSIXct</span>(<span class="st">&quot;2012-06-01 23:00:00 EDT&quot;</span>))<span class="op">:</span><span class="kw">length</span>(daily<span class="op">$</span>date),]</a>
<a class="sourceLine" id="cb517-3" data-line-number="3"></a>
<a class="sourceLine" id="cb517-4" data-line-number="4">train =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">date =</span> train<span class="op">$</span>date, <span class="dt">air_temperature =</span>  train<span class="op">$</span>air_temperature)</a>
<a class="sourceLine" id="cb517-5" data-line-number="5">test =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">date =</span> test<span class="op">$</span>date, <span class="dt">air_temperature =</span>  test<span class="op">$</span>air_temperature)</a>
<a class="sourceLine" id="cb517-6" data-line-number="6"></a>
<a class="sourceLine" id="cb517-7" data-line-number="7"><span class="co"># print out the results of our split</span></a>
<a class="sourceLine" id="cb517-8" data-line-number="8"><span class="kw">head</span>(train)</a></code></pre></div>
<pre><code>##                  date air_temperature
## 1 2010-01-01 23:00:00        4.352076
## 2 2010-01-02 23:00:00       -4.916312
## 3 2010-01-03 23:00:00        4.264553
## 4 2010-01-04 23:00:00        9.920745
## 5 2010-01-05 23:00:00       11.206665
## 6 2010-01-06 23:00:00       12.708645</code></pre>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb519-1" data-line-number="1"><span class="kw">head</span>(test)</a></code></pre></div>
<pre><code>##                  date air_temperature
## 1 2012-06-01 23:00:00        54.73873
## 2 2012-06-02 23:00:00        59.44044
## 3 2012-06-03 23:00:00        63.61205
## 4 2012-06-04 23:00:00        64.61727
## 5 2012-06-05 23:00:00        61.49611
## 6 2012-06-06 23:00:00        62.09221</code></pre>
<p>We have our test and train datasets, but now we must prepare these datasets for the linear regression model. Remember, we are trying to train the model using the train dataset and use that model to accurately predict the temperature values of the test dataset. We’ll need to provide the model with some information regarding the number of variables that go into the model.</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb521-1" data-line-number="1"><span class="kw">library</span>(timetk)</a>
<a class="sourceLine" id="cb521-2" data-line-number="2"><span class="kw">library</span>(recipes)</a>
<a class="sourceLine" id="cb521-3" data-line-number="3"><span class="co"># create a recipe for the air temperature variable</span></a>
<a class="sourceLine" id="cb521-4" data-line-number="4">rec_train =<span class="st"> </span><span class="kw">recipe</span>(air_temperature <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> train)</a>
<a class="sourceLine" id="cb521-5" data-line-number="5">recipe_ts =<span class="st"> </span><span class="kw">step_timeseries_signature</span>(<span class="dt">recipe =</span> rec_train, <span class="st">&quot;date&quot;</span>) </a>
<a class="sourceLine" id="cb521-6" data-line-number="6"></a>
<a class="sourceLine" id="cb521-7" data-line-number="7">recipe_ts</a></code></pre></div>
<pre><code>## Data Recipe
## 
## Inputs:
## 
##       role #variables
##    outcome          1
##  predictor          1
## 
## Operations:
## 
## Timeseries signature features from &quot;date&quot;</code></pre>
<p>We only have 1 predictor (day of year) and 1 outcome variable (air temperature). When we initiate a linear regression model for a time series, the model will add extra columns (second, minute, hour, day of year, week of year, weekday, etc.) to the training dataset. Remember, we’re creating a <em>recipe</em> that holds instructions for the actual model. We can add recipe instructions on whether to evaluate the interaction of these columns and Air Temperature or not. We’ll remove seconds, minutes, hours since we are at a daily resolution. These instructions are used on the training dataframe while it’s training the particular model but does not impact the actual dataframe itself.</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb523-1" data-line-number="1">recipe_spec =<span class="st"> </span>recipe_ts</a>
<a class="sourceLine" id="cb523-2" data-line-number="2"><span class="co"># when we run the model, extra dat values will be added automatically - so let&#39;s remove our default date column when teh model is run - note this does not change the dataframe</span></a>
<a class="sourceLine" id="cb523-3" data-line-number="3">recipe_spec =<span class="st"> </span><span class="kw">step_rm</span>(recipe_spec, date)</a>
<a class="sourceLine" id="cb523-4" data-line-number="4"><span class="co"># some other variables will be added in automatically as well, let&#39;s remove the ones that aren&#39;t imoprtant. </span></a>
<a class="sourceLine" id="cb523-5" data-line-number="5">recipe_spec =<span class="st"> </span><span class="kw">step_rm</span>(recipe_spec, <span class="kw">contains</span>(<span class="st">&quot;iso&quot;</span>), </a>
<a class="sourceLine" id="cb523-6" data-line-number="6">            <span class="kw">contains</span>(<span class="st">&quot;second&quot;</span>), <span class="kw">contains</span>(<span class="st">&quot;minute&quot;</span>), <span class="kw">contains</span>(<span class="st">&quot;hour&quot;</span>),</a>
<a class="sourceLine" id="cb523-7" data-line-number="7">            <span class="kw">contains</span>(<span class="st">&quot;am.pm&quot;</span>), <span class="kw">contains</span>(<span class="st">&quot;xts&quot;</span>))</a>
<a class="sourceLine" id="cb523-8" data-line-number="8"><span class="co"># create new columns based on the interaction of these variables</span></a>
<a class="sourceLine" id="cb523-9" data-line-number="9">recipe_spec =<span class="st"> </span><span class="kw">step_interact</span>(recipe_spec, <span class="op">~</span><span class="st"> </span>date_month.lbl <span class="op">*</span><span class="st"> </span>date_day)</a>
<a class="sourceLine" id="cb523-10" data-line-number="10">recipe_spec =<span class="st"> </span><span class="kw">step_interact</span>(recipe_spec, <span class="op">~</span><span class="st"> </span>date_month.lbl <span class="op">*</span><span class="st"> </span>date_mweek)</a>
<a class="sourceLine" id="cb523-11" data-line-number="11">recipe_spec =<span class="st"> </span><span class="kw">step_interact</span>(recipe_spec, <span class="op">~</span><span class="st"> </span>date_month.lbl <span class="op">*</span><span class="st"> </span>date_wday.lbl <span class="op">*</span><span class="st"> </span>date_yday)</a>
<a class="sourceLine" id="cb523-12" data-line-number="12">recipe_spec_final =<span class="st"> </span><span class="kw">step_dummy</span>(recipe_spec, <span class="kw">contains</span>(<span class="st">&quot;lbl&quot;</span>), <span class="dt">one_hot =</span> <span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb523-13" data-line-number="13"></a>
<a class="sourceLine" id="cb523-14" data-line-number="14">recipe_spec_final</a></code></pre></div>
<pre><code>## Data Recipe
## 
## Inputs:
## 
##       role #variables
##    outcome          1
##  predictor          1
## 
## Operations:
## 
## Timeseries signature features from &quot;date&quot;
## Delete terms date
## Delete terms contains(&quot;iso&quot;), contains(&quot;second&quot;), ...
## Interactions with date_month.lbl * date_day
## Interactions with date_month.lbl * date_mweek
## Interactions with date_month.lbl * date_wday.lbl * date_yday
## Dummy variables from contains(&quot;lbl&quot;)</code></pre>
<p>Our instructions have been specified, now let’s use the <code>linear_reg</code> function from the <code>parsnip</code> package to create the instance. We’ll need to set an engine to run the model (there are multiple regression model engines that are beyond the scope of this tutorial) and that engine will be <code>glmnet</code>. We’ll initiate the model, create a workflow for the model where we add in our prewritten recipe above, then we’ll add our model to the workflow. Once it’s ready, we can run the model and it’s workflow using the <code>fit</code> function. Our model has been trained. Now, we can use our trained model to predict the test air temperature based on the test date.</p>
</div>
<div id="running-the-model" class="section level2">
<h2><span class="header-section-number">18.4</span> Running the Model</h2>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb525-1" data-line-number="1"><span class="kw">library</span>(workflows)</a>
<a class="sourceLine" id="cb525-2" data-line-number="2"><span class="kw">library</span>(parsnip)</a>
<a class="sourceLine" id="cb525-3" data-line-number="3"><span class="kw">library</span>(recipes)</a>
<a class="sourceLine" id="cb525-4" data-line-number="4"><span class="kw">library</span>(yardstick)</a>
<a class="sourceLine" id="cb525-5" data-line-number="5"><span class="kw">library</span>(glmnet)</a>
<a class="sourceLine" id="cb525-6" data-line-number="6"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb525-7" data-line-number="7"></a>
<a class="sourceLine" id="cb525-8" data-line-number="8"><span class="co"># initiate the model with a penalty of 2 and no mixture - these parameters can be changed for more variability</span></a>
<a class="sourceLine" id="cb525-9" data-line-number="9">model_spec_glmnet &lt;-<span class="st"> </span>parsnip<span class="op">::</span><span class="kw">linear_reg</span>(<span class="dt">mode =</span> <span class="st">&quot;regression&quot;</span>, <span class="dt">penalty =</span> <span class="dv">2</span>, <span class="dt">mixture =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb525-10" data-line-number="10"><span class="kw">set_engine</span>(model_spec_glmnet, <span class="st">&quot;glmnet&quot;</span>)</a></code></pre></div>
<pre><code>## Linear Regression Model Specification (regression)
## 
## Main Arguments:
##   penalty = 2
##   mixture = 0
## 
## Computational engine: glmnet</code></pre>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb527-1" data-line-number="1"><span class="co"># add our recipe to the workflow, then add the model to the workflow</span></a>
<a class="sourceLine" id="cb527-2" data-line-number="2">workflow_glmnet =<span class="st"> </span><span class="kw">add_recipe</span>(<span class="kw">workflow</span>(), recipe_spec_final)</a>
<a class="sourceLine" id="cb527-3" data-line-number="3">workflow_glmnet =<span class="st"> </span><span class="kw">add_model</span>(workflow_glmnet, model_spec_glmnet)</a>
<a class="sourceLine" id="cb527-4" data-line-number="4">workflow_glmnet</a></code></pre></div>
<pre><code>## ══ Workflow ═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
## Preprocessor: Recipe
## Model: linear_reg()
## 
## ── Preprocessor ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## 7 Recipe Steps
## 
## ● step_timeseries_signature()
## ● step_rm()
## ● step_rm()
## ● step_interact()
## ● step_interact()
## ● step_interact()
## ● step_dummy()
## 
## ── Model ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## Linear Regression Model Specification (regression)
## 
## Main Arguments:
##   penalty = 2
##   mixture = 0</code></pre>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb529-1" data-line-number="1"><span class="co"># tune the model based on the training data</span></a>
<a class="sourceLine" id="cb529-2" data-line-number="2">workflow_trained &lt;-<span class="st"> </span>workflow_glmnet</a>
<a class="sourceLine" id="cb529-3" data-line-number="3">workflow_trained =<span class="st"> </span><span class="kw">fit</span>(workflow_glmnet, <span class="dt">data =</span> train)</a>
<a class="sourceLine" id="cb529-4" data-line-number="4"></a>
<a class="sourceLine" id="cb529-5" data-line-number="5"><span class="co"># predict the test air temperature based on our model</span></a>
<a class="sourceLine" id="cb529-6" data-line-number="6">prediction_tbl =<span class="st"> </span><span class="kw">predict</span>(workflow_trained, test)</a>
<a class="sourceLine" id="cb529-7" data-line-number="7">prediction_tbl =<span class="st"> </span><span class="kw">bind_cols</span>(prediction_tbl, test) </a>
<a class="sourceLine" id="cb529-8" data-line-number="8">prediction_tbl</a></code></pre></div>
<pre><code>## # A tibble: 214 x 3
##    .pred date                air_temperature
##    &lt;dbl&gt; &lt;dttm&gt;                        &lt;dbl&gt;
##  1  64.5 2012-06-01 23:00:00            54.7
##  2  65.8 2012-06-02 23:00:00            59.4
##  3  67.1 2012-06-03 23:00:00            63.6
##  4  72.4 2012-06-04 23:00:00            64.6
##  5  77.6 2012-06-05 23:00:00            61.5
##  6  69.0 2012-06-06 23:00:00            62.1
##  7  64.6 2012-06-07 23:00:00            66.3
##  8  69.1 2012-06-08 23:00:00            68.3
##  9  69.6 2012-06-09 23:00:00            74.9
## 10  65.3 2012-06-10 23:00:00            73.8
## # … with 204 more rows</code></pre>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb531-1" data-line-number="1"><span class="co"># plot our modeled test air temperature against the actual test air temperature</span></a>
<a class="sourceLine" id="cb531-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> daily, <span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> air_temperature)) <span class="op">+</span></a>
<a class="sourceLine" id="cb531-3" data-line-number="3"><span class="st">    </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;2010-01-01&quot;</span>),</a>
<a class="sourceLine" id="cb531-4" data-line-number="4">              <span class="dt">xmax =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;2012-06-01&quot;</span>),</a>
<a class="sourceLine" id="cb531-5" data-line-number="5">              <span class="dt">ymin =</span> <span class="dv">-10</span>, <span class="dt">ymax =</span> <span class="dv">85</span>,</a>
<a class="sourceLine" id="cb531-6" data-line-number="6">              <span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.01</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb531-7" data-line-number="7"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;2011-01-01&quot;</span>) , <span class="dt">y =</span> <span class="dv">75</span>,</a>
<a class="sourceLine" id="cb531-8" data-line-number="8">             <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Train Region&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb531-9" data-line-number="9"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;2012-12-01&quot;</span>), <span class="dt">y =</span> <span class="dv">75</span>,</a>
<a class="sourceLine" id="cb531-10" data-line-number="10">             <span class="dt">color =</span> <span class="st">&quot;coral&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Test Region&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb531-11" data-line-number="11"><span class="st">   </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb531-12" data-line-number="12"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> .pred), <span class="dt">data =</span> prediction_tbl, </a>
<a class="sourceLine" id="cb531-13" data-line-number="13">               <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">color =</span>  <span class="st">&quot;darkblue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb531-14" data-line-number="14"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;GLM: Out-Of-Sample Forecast&quot;</span>)</a></code></pre></div>
<p><img src="R_Geospatial_Sciences_files/figure-html/unnamed-chunk-211-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="validation-and-accuracy" class="section level2">
<h2><span class="header-section-number">18.5</span> Validation and Accuracy</h2>
<p>The plot seems to show that the model predicted the test air temperature fairly well, but let’s evaluate the metrics the see how it does based on the statistics. Then, let’s plot the residuals - the difference between the actual test air temperature and the predicted air temperature.</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb532-1" data-line-number="1"><span class="co"># calculate the metrics of test air temperature vs. predicted air temperature</span></a>
<a class="sourceLine" id="cb532-2" data-line-number="2"><span class="kw">metrics</span>(prediction_tbl, air_temperature, .pred)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 rmse    standard      11.2  
## 2 rsq     standard       0.778
## 3 mae     standard       8.89</code></pre>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb534-1" data-line-number="1"><span class="co"># plot the residuals</span></a>
<a class="sourceLine" id="cb534-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> prediction_tbl, <span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> air_temperature <span class="op">-</span><span class="st"> </span>.pred)) <span class="op">+</span></a>
<a class="sourceLine" id="cb534-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb534-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb534-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">span =</span> <span class="fl">0.05</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb534-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">span =</span> <span class="fl">1.00</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb534-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;GLM Model Residuals, Out-of-Sample&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Air Temperature: Actual - Predicted&quot;</span>,  <span class="dt">x =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb534-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>))</a></code></pre></div>
<p><img src="R_Geospatial_Sciences_files/figure-html/unnamed-chunk-212-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>Remember, we don’t want to overfit our model and make it too accurate! Overfitting of our model to the training dataset can create unrealistic outcomes with unrealistic regularity. Temperatures are variable!</p>
</div>
<div id="future-forecasting" class="section level2">
<h2><span class="header-section-number">18.6</span> Future Forecasting</h2>
<p>The residuals show the model performed fairly well. Now, can we forecast the temperature into the future? We’ll follow the same procedure as before but now we’ll create extra time series values and fill those using the model we’ve built</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb535-1" data-line-number="1"><span class="co"># Extract daily index</span></a>
<a class="sourceLine" id="cb535-2" data-line-number="2">idx &lt;-<span class="st"> </span><span class="kw">tk_index</span>(daily)</a>
<a class="sourceLine" id="cb535-3" data-line-number="3"><span class="co"># Get time series summary from index</span></a>
<a class="sourceLine" id="cb535-4" data-line-number="4">daily_summary &lt;-<span class="st"> </span><span class="kw">tk_get_timeseries_summary</span>(idx)</a>
<a class="sourceLine" id="cb535-5" data-line-number="5"></a>
<a class="sourceLine" id="cb535-6" data-line-number="6"><span class="co"># add 180 days to the model </span></a>
<a class="sourceLine" id="cb535-7" data-line-number="7">idx_future &lt;-<span class="st"> </span><span class="kw">tk_make_future_timeseries</span>(idx, <span class="dt">n_future =</span> <span class="dv">180</span>)</a>
<a class="sourceLine" id="cb535-8" data-line-number="8"><span class="co"># create a tibble table </span></a>
<a class="sourceLine" id="cb535-9" data-line-number="9">future_tbl &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">date =</span> idx_future) </a>
<a class="sourceLine" id="cb535-10" data-line-number="10"><span class="kw">head</span>(future_tbl)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 1
##   date               
##   &lt;dttm&gt;             
## 1 2013-01-01 00:00:00
## 2 2013-01-02 00:00:00
## 3 2013-01-03 00:00:00
## 4 2013-01-04 00:00:00
## 5 2013-01-05 00:00:00
## 6 2013-01-06 00:00:00</code></pre>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb537-1" data-line-number="1"><span class="co"># run the model using the entire dataset, predict the temperature for the dates of future_tbl, and bind the columns together. </span></a>
<a class="sourceLine" id="cb537-2" data-line-number="2">future_predictions_tbl =<span class="st"> </span><span class="kw">fit</span>(workflow_glmnet, <span class="dt">data =</span> daily)</a>
<a class="sourceLine" id="cb537-3" data-line-number="3">future_predictions_tbl =<span class="st"> </span><span class="kw">predict</span>(future_predictions_tbl, future_tbl)</a>
<a class="sourceLine" id="cb537-4" data-line-number="4">future_predictions_tbl =<span class="st"> </span><span class="kw">bind_cols</span>(future_predictions_tbl, future_tbl)</a>
<a class="sourceLine" id="cb537-5" data-line-number="5"></a>
<a class="sourceLine" id="cb537-6" data-line-number="6"><span class="co"># plot the future forecasted temperature</span></a>
<a class="sourceLine" id="cb537-7" data-line-number="7"><span class="kw">ggplot</span>(<span class="dt">data =</span> daily, <span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> air_temperature)) <span class="op">+</span></a>
<a class="sourceLine" id="cb537-8" data-line-number="8"><span class="st">    </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;2010-01-01&quot;</span>),</a>
<a class="sourceLine" id="cb537-9" data-line-number="9">              <span class="dt">xmax =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;2012-06-01&quot;</span>),</a>
<a class="sourceLine" id="cb537-10" data-line-number="10">              <span class="dt">ymin =</span> <span class="dv">-10</span>, <span class="dt">ymax =</span> <span class="dv">85</span>,</a>
<a class="sourceLine" id="cb537-11" data-line-number="11">              <span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.01</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb537-12" data-line-number="12"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;2011-01-01&quot;</span>) , <span class="dt">y =</span> <span class="dv">75</span>,</a>
<a class="sourceLine" id="cb537-13" data-line-number="13">             <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Train Region&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb537-14" data-line-number="14"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;2012-12-01&quot;</span>), <span class="dt">y =</span> <span class="dv">75</span>,</a>
<a class="sourceLine" id="cb537-15" data-line-number="15">             <span class="dt">color =</span> <span class="st">&quot;coral&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Test Region&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb537-16" data-line-number="16"><span class="st">   </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb537-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">as.POSIXct</span>(date), <span class="dt">y =</span> .pred), <span class="dt">data =</span> future_predictions_tbl,</a>
<a class="sourceLine" id="cb537-18" data-line-number="18">               <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;dodgerblue1&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb537-19" data-line-number="19"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">as.POSIXct</span>(date), <span class="dt">y =</span> .pred), <span class="dt">data =</span> future_predictions_tbl,</a>
<a class="sourceLine" id="cb537-20" data-line-number="20">                <span class="dt">method =</span> <span class="st">&#39;loess&#39;</span>, <span class="dt">color =</span> <span class="st">&quot;dodgerblue4&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb537-21" data-line-number="21"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Willow Creek Air Temperature: 6-Month Forecast&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Air Temperature (F)&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="R_Geospatial_Sciences_files/figure-html/unnamed-chunk-213-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>Let’s add in some error regions. We’ll calculate the spread of the 95th percentile and the 80th percentile confidence intervals. 95% of the area under a normal curve lies within roughly 1.96 standard deviations of the mean, and due to the central limit theorem, this number is therefore used in the construction of approximate 95% confidence intervals. For 80%, the are under a normal curve lies within roughly 1.28 standard deviations. We’ll use these values to create our prediction error thresholds.</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb538-1" data-line-number="1"><span class="co"># Calculate standard deviation of residuals (actual temp subtracted from residuals)</span></a>
<a class="sourceLine" id="cb538-2" data-line-number="2">test_resid_sd &lt;-<span class="st"> </span><span class="kw">summarize</span>(prediction_tbl, <span class="dt">stdev =</span> <span class="kw">sd</span>(air_temperature<span class="op">-</span><span class="st"> </span>.pred))</a>
<a class="sourceLine" id="cb538-3" data-line-number="3"><span class="co"># create lo.95 and other variables for the error areas</span></a>
<a class="sourceLine" id="cb538-4" data-line-number="4">future_predictions_tbl &lt;-<span class="st"> </span><span class="kw">mutate</span>(future_predictions_tbl, </a>
<a class="sourceLine" id="cb538-5" data-line-number="5">        <span class="dt">lo.95 =</span> .pred <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>test_resid_sd<span class="op">$</span>stdev,</a>
<a class="sourceLine" id="cb538-6" data-line-number="6">        <span class="dt">lo.80 =</span> .pred <span class="op">-</span><span class="st"> </span><span class="fl">1.28</span> <span class="op">*</span><span class="st"> </span>test_resid_sd<span class="op">$</span>stdev,</a>
<a class="sourceLine" id="cb538-7" data-line-number="7">        <span class="dt">hi.80 =</span> .pred <span class="op">+</span><span class="st"> </span><span class="fl">1.28</span> <span class="op">*</span><span class="st"> </span>test_resid_sd<span class="op">$</span>stdev,</a>
<a class="sourceLine" id="cb538-8" data-line-number="8">        <span class="dt">hi.95 =</span> .pred <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>test_resid_sd<span class="op">$</span>stdev)</a>
<a class="sourceLine" id="cb538-9" data-line-number="9"></a>
<a class="sourceLine" id="cb538-10" data-line-number="10"><span class="co"># plot the error areas</span></a>
<a class="sourceLine" id="cb538-11" data-line-number="11"><span class="kw">ggplot</span>(<span class="dt">data =</span> daily, <span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> air_temperature)) <span class="op">+</span></a>
<a class="sourceLine" id="cb538-12" data-line-number="12"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb538-13" data-line-number="13"><span class="st">    </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">y =</span> .pred, <span class="dt">x =</span> <span class="kw">as.POSIXct</span>(date),<span class="dt">ymin =</span> lo<span class="fl">.95</span>, <span class="dt">ymax =</span> hi<span class="fl">.95</span>), </a>
<a class="sourceLine" id="cb538-14" data-line-number="14">                <span class="dt">data =</span> future_predictions_tbl, </a>
<a class="sourceLine" id="cb538-15" data-line-number="15">                <span class="dt">fill =</span> <span class="st">&quot;#D5DBFF&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb538-16" data-line-number="16"><span class="st">    </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">y =</span> .pred, <span class="dt">x =</span> <span class="kw">as.POSIXct</span>(date),<span class="dt">ymin =</span> lo<span class="fl">.80</span>, <span class="dt">ymax =</span> hi<span class="fl">.80</span>, <span class="dt">fill =</span> key), </a>
<a class="sourceLine" id="cb538-17" data-line-number="17">                <span class="dt">data =</span> future_predictions_tbl,</a>
<a class="sourceLine" id="cb538-18" data-line-number="18">                <span class="dt">fill =</span> <span class="st">&quot;#596DD5&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">0</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb538-19" data-line-number="19"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">as.POSIXct</span>(date), <span class="dt">y =</span> .pred), <span class="dt">data =</span> future_predictions_tbl,</a>
<a class="sourceLine" id="cb538-20" data-line-number="20">               <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb538-21" data-line-number="21"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">as.POSIXct</span>(date), <span class="dt">y =</span> .pred), <span class="dt">data =</span> future_predictions_tbl,</a>
<a class="sourceLine" id="cb538-22" data-line-number="22">                <span class="dt">method =</span> <span class="st">&#39;loess&#39;</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>)<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb538-23" data-line-number="23"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Willow Creek Daily Air Temperature: 6 Month Forecast&quot;</span>,<span class="dt">y =</span> <span class="st">&quot;Air Temperature (F)&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="R_Geospatial_Sciences_files/figure-html/unnamed-chunk-214-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>Remember, no forecast is ever perfect!</p>
</div>
<div id="assignment-10" class="section level2">
<h2><span class="header-section-number">18.7</span> Assignment</h2>
<p>Perform the same analysis for the Willow Creek Air Temperature (2010,2011, and 2012 datasets) but this time aggregate to a <strong>weekly</strong> resolution using the <code>apply.weekly()</code> function from <code>xts</code>. Proceed with the same workflow and create the same plots. Add plots to a document (Word, Google Docs, or RMarkdown file, your choice) and answer the following questions;</p>
<ol style="list-style-type: decimal">
<li>How does the weekly resolution model compare to the daily resolution model?</li>
<li>Why do you think it performs better/worse?</li>
<li>How could we enhance the accuracy of the model?</li>
</ol>
<p>Upload file (as word doc, PDF, whatever works) to UD Canvas.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="machine-learning-with-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="random-forest-modeling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
