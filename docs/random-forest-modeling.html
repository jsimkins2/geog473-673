<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>19 Random Forest Modeling | R for Geospatial Sciences</title>
  <meta name="description" content="Advanced R" />
  <meta name="generator" content="bookdown 0.20.6 and GitBook 2.6.7" />

  <meta property="og:title" content="19 Random Forest Modeling | R for Geospatial Sciences" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Advanced R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="19 Random Forest Modeling | R for Geospatial Sciences" />
  
  <meta name="twitter:description" content="Advanced R" />
  

<meta name="author" content="James Simkins" />


<meta name="date" content="2021-01-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="time-series-forecasting.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
<script src="libs/FlatGeoBuf-3.3.3/fgb.js"></script>
<script src="libs/FlatGeoBuf-3.3.3/flatgeobuf-geojson.min.js"></script>
<script src="libs/chromajs-2.1.0/chroma.min.js"></script>
<link id="merged_coast[maxpred]-1-attachment" rel="attachment" href="libs/merged_coast[maxpred]-0.0.1/merged_coast[maxpred]_layer.fgb"/>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />
<link id="m[name]-1-attachment" rel="attachment" href="libs/m[name]-0.0.1/m[name]_layer.fgb"/>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for Geospatial Sciences</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="r-for-geospatial-sciences.html"><a href="r-for-geospatial-sciences.html"><i class="fa fa-check"></i><b>1</b> R for Geospatial Sciences</a><ul>
<li class="chapter" data-level="1.1" data-path="r-for-geospatial-sciences.html"><a href="r-for-geospatial-sciences.html#welcome"><i class="fa fa-check"></i><b>1.1</b> Welcome</a></li>
<li class="chapter" data-level="1.2" data-path="r-for-geospatial-sciences.html"><a href="r-for-geospatial-sciences.html#course-github"><i class="fa fa-check"></i><b>1.2</b> Course Github</a></li>
<li class="chapter" data-level="1.3" data-path="r-for-geospatial-sciences.html"><a href="r-for-geospatial-sciences.html#syllabus"><i class="fa fa-check"></i><b>1.3</b> Syllabus</a></li>
<li class="chapter" data-level="1.4" data-path="r-for-geospatial-sciences.html"><a href="r-for-geospatial-sciences.html#phase-1"><i class="fa fa-check"></i><b>1.4</b> Phase 1</a></li>
<li class="chapter" data-level="1.5" data-path="r-for-geospatial-sciences.html"><a href="r-for-geospatial-sciences.html#phase-2"><i class="fa fa-check"></i><b>1.5</b> Phase 2</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i><b>2</b> Getting Started with R</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#why-is-there-such-a-buzz-around-r"><i class="fa fa-check"></i><b>2.1</b> Why is there such a buzz around R?</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#reasons-to-love-r"><i class="fa fa-check"></i><b>2.2</b> Reasons to love R</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#downloading-guide"><i class="fa fa-check"></i><b>2.3</b> Downloading Guide</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#rstudio"><i class="fa fa-check"></i><b>2.4</b> Rstudio</a></li>
<li class="chapter" data-level="2.5" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#download-course-datasets"><i class="fa fa-check"></i><b>2.5</b> Download Course Datasets</a></li>
<li class="chapter" data-level="2.6" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#video-examples"><i class="fa fa-check"></i><b>2.6</b> Video Examples</a></li>
<li class="chapter" data-level="2.7" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#getting-familiar-with-rstudio"><i class="fa fa-check"></i><b>2.7</b> Getting familiar with RStudio</a></li>
<li class="chapter" data-level="2.8" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#open-rstudio"><i class="fa fa-check"></i><b>2.8</b> Open RStudio</a></li>
<li class="chapter" data-level="2.9" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#r-studio-layout"><i class="fa fa-check"></i><b>2.9</b> R Studio Layout</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="definitions-rules.html"><a href="definitions-rules.html"><i class="fa fa-check"></i><b>3</b> Definitions &amp; Rules</a><ul>
<li class="chapter" data-level="3.1" data-path="definitions-rules.html"><a href="definitions-rules.html#important-r-programming-definitions"><i class="fa fa-check"></i><b>3.1</b> Important R Programming Definitions</a></li>
<li class="chapter" data-level="3.2" data-path="definitions-rules.html"><a href="definitions-rules.html#rules"><i class="fa fa-check"></i><b>3.2</b> Rules</a></li>
<li class="chapter" data-level="3.3" data-path="definitions-rules.html"><a href="definitions-rules.html#general-recommendations"><i class="fa fa-check"></i><b>3.3</b> General Recommendations</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html"><i class="fa fa-check"></i><b>4</b> R Coding Fundamentals</a><ul>
<li class="chapter" data-level="4.1" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#entering-input"><i class="fa fa-check"></i><b>4.1</b> Entering Input</a></li>
<li class="chapter" data-level="4.2" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#running-code"><i class="fa fa-check"></i><b>4.2</b> Running Code</a></li>
<li class="chapter" data-level="4.3" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#evaluation"><i class="fa fa-check"></i><b>4.3</b> Evaluation</a></li>
<li class="chapter" data-level="4.4" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#r-objects"><i class="fa fa-check"></i><b>4.4</b> R Objects</a></li>
<li class="chapter" data-level="4.5" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#numbers"><i class="fa fa-check"></i><b>4.5</b> Numbers</a></li>
<li class="chapter" data-level="4.6" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#attributes"><i class="fa fa-check"></i><b>4.6</b> Attributes</a></li>
<li class="chapter" data-level="4.7" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#creating-vectors"><i class="fa fa-check"></i><b>4.7</b> Creating Vectors</a></li>
<li class="chapter" data-level="4.8" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#mixing-objects"><i class="fa fa-check"></i><b>4.8</b> Mixing Objects</a></li>
<li class="chapter" data-level="4.9" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#explicit-coercion"><i class="fa fa-check"></i><b>4.9</b> Explicit Coercion</a></li>
<li class="chapter" data-level="4.10" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#matrices"><i class="fa fa-check"></i><b>4.10</b> Matrices</a></li>
<li class="chapter" data-level="4.11" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#lists"><i class="fa fa-check"></i><b>4.11</b> Lists</a></li>
<li class="chapter" data-level="4.12" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#factors"><i class="fa fa-check"></i><b>4.12</b> Factors</a></li>
<li class="chapter" data-level="4.13" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#missing-values"><i class="fa fa-check"></i><b>4.13</b> Missing Values</a></li>
<li class="chapter" data-level="4.14" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#data-frames"><i class="fa fa-check"></i><b>4.14</b> Data Frames</a></li>
<li class="chapter" data-level="4.15" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#names"><i class="fa fa-check"></i><b>4.15</b> Names</a></li>
<li class="chapter" data-level="4.16" data-path="r-coding-fundamentals.html"><a href="r-coding-fundamentals.html#summary"><i class="fa fa-check"></i><b>4.16</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="basic-r-scripts.html"><a href="basic-r-scripts.html"><i class="fa fa-check"></i><b>5</b> Basic R Scripts</a><ul>
<li class="chapter" data-level="5.1" data-path="basic-r-scripts.html"><a href="basic-r-scripts.html#global-carbon-dioxide-concentrations"><i class="fa fa-check"></i><b>5.1</b> Global Carbon-Dioxide Concentrations</a><ul>
<li class="chapter" data-level="5.1.1" data-path="basic-r-scripts.html"><a href="basic-r-scripts.html#saving-your-plot"><i class="fa fa-check"></i><b>5.1.1</b> Saving your plot</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="basic-r-scripts.html"><a href="basic-r-scripts.html#cars---motor-trends-magazine-data"><i class="fa fa-check"></i><b>5.2</b> Cars - Motor Trends Magazine Data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="scientific-r-scripts.html"><a href="scientific-r-scripts.html"><i class="fa fa-check"></i><b>6</b> Scientific R Scripts</a><ul>
<li class="chapter" data-level="6.1" data-path="scientific-r-scripts.html"><a href="scientific-r-scripts.html#script-breakdown"><i class="fa fa-check"></i><b>6.1</b> Script Breakdown</a><ul>
<li class="chapter" data-level="6.1.1" data-path="scientific-r-scripts.html"><a href="scientific-r-scripts.html#installing-packages"><i class="fa fa-check"></i><b>6.1.1</b> Installing Packages</a></li>
<li class="chapter" data-level="6.1.2" data-path="scientific-r-scripts.html"><a href="scientific-r-scripts.html#reading-the-data"><i class="fa fa-check"></i><b>6.1.2</b> Reading the Data</a></li>
<li class="chapter" data-level="6.1.3" data-path="scientific-r-scripts.html"><a href="scientific-r-scripts.html#basic-quality-control"><i class="fa fa-check"></i><b>6.1.3</b> Basic Quality Control</a></li>
<li class="chapter" data-level="6.1.4" data-path="scientific-r-scripts.html"><a href="scientific-r-scripts.html#plotting-the-data"><i class="fa fa-check"></i><b>6.1.4</b> Plotting the Data</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="scientific-r-scripts.html"><a href="scientific-r-scripts.html#in-class-exercise"><i class="fa fa-check"></i><b>6.2</b> In Class Exercise</a><ul>
<li class="chapter" data-level="6.2.1" data-path="scientific-r-scripts.html"><a href="scientific-r-scripts.html#further-explanation-of-datatypes"><i class="fa fa-check"></i><b>6.2.1</b> Further Explanation of DataTypes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="time-series-data.html"><a href="time-series-data.html"><i class="fa fa-check"></i><b>7</b> Time Series Data</a><ul>
<li class="chapter" data-level="7.1" data-path="time-series-data.html"><a href="time-series-data.html#for-loops"><i class="fa fa-check"></i><b>7.1</b> For Loops</a></li>
<li class="chapter" data-level="7.2" data-path="time-series-data.html"><a href="time-series-data.html#deos-data"><i class="fa fa-check"></i><b>7.2</b> DEOS Data</a></li>
<li class="chapter" data-level="7.3" data-path="time-series-data.html"><a href="time-series-data.html#assignment"><i class="fa fa-check"></i><b>7.3</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="raster-visualization.html"><a href="raster-visualization.html"><i class="fa fa-check"></i><b>8</b> Raster Visualization</a><ul>
<li class="chapter" data-level="8.1" data-path="raster-visualization.html"><a href="raster-visualization.html#paste0"><i class="fa fa-check"></i><b>8.1</b> <code>Paste0()</code></a></li>
<li class="chapter" data-level="8.2" data-path="raster-visualization.html"><a href="raster-visualization.html#rasters"><i class="fa fa-check"></i><b>8.2</b> Rasters</a></li>
<li class="chapter" data-level="8.3" data-path="raster-visualization.html"><a href="raster-visualization.html#assignment-1"><i class="fa fa-check"></i><b>8.3</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="reprojecting-writing-rasters.html"><a href="reprojecting-writing-rasters.html"><i class="fa fa-check"></i><b>9</b> Reprojecting &amp; Writing Rasters</a><ul>
<li class="chapter" data-level="9.1" data-path="reprojecting-writing-rasters.html"><a href="reprojecting-writing-rasters.html#indexing-data"><i class="fa fa-check"></i><b>9.1</b> Indexing Data</a></li>
<li class="chapter" data-level="9.2" data-path="reprojecting-writing-rasters.html"><a href="reprojecting-writing-rasters.html#resampling-and-reprojecting"><i class="fa fa-check"></i><b>9.2</b> Resampling and Reprojecting</a></li>
<li class="chapter" data-level="9.3" data-path="reprojecting-writing-rasters.html"><a href="reprojecting-writing-rasters.html#pngs"><i class="fa fa-check"></i><b>9.3</b> PNGs</a></li>
<li class="chapter" data-level="9.4" data-path="reprojecting-writing-rasters.html"><a href="reprojecting-writing-rasters.html#writing-rasters"><i class="fa fa-check"></i><b>9.4</b> Writing Rasters</a></li>
<li class="chapter" data-level="9.5" data-path="reprojecting-writing-rasters.html"><a href="reprojecting-writing-rasters.html#assignment-2"><i class="fa fa-check"></i><b>9.5</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="plot-customization.html"><a href="plot-customization.html"><i class="fa fa-check"></i><b>10</b> Plot Customization</a><ul>
<li class="chapter" data-level="10.1" data-path="plot-customization.html"><a href="plot-customization.html#expanding-on-basic-plots-in-r"><i class="fa fa-check"></i><b>10.1</b> Expanding on Basic Plots in R</a><ul>
<li class="chapter" data-level="10.1.1" data-path="plot-customization.html"><a href="plot-customization.html#adding-to-a-plot"><i class="fa fa-check"></i><b>10.1.1</b> Adding to a Plot</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="plot-customization.html"><a href="plot-customization.html#barplots-boxplots-pie-charts"><i class="fa fa-check"></i><b>10.2</b> Barplots, Boxplots, Pie Charts</a><ul>
<li class="chapter" data-level="10.2.1" data-path="plot-customization.html"><a href="plot-customization.html#combining-plots"><i class="fa fa-check"></i><b>10.2.1</b> Combining Plots</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="plot-customization.html"><a href="plot-customization.html#tree-data"><i class="fa fa-check"></i><b>10.3</b> Tree Data</a><ul>
<li class="chapter" data-level="10.3.1" data-path="plot-customization.html"><a href="plot-customization.html#loading-the-dataset"><i class="fa fa-check"></i><b>10.3.1</b> Loading the Dataset</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="plot-customization.html"><a href="plot-customization.html#assignment-3"><i class="fa fa-check"></i><b>10.4</b> Assignment:</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="basic-statistics.html"><a href="basic-statistics.html"><i class="fa fa-check"></i><b>11</b> Basic Statistics</a><ul>
<li class="chapter" data-level="11.1" data-path="basic-statistics.html"><a href="basic-statistics.html#statistical-function-dictionary"><i class="fa fa-check"></i><b>11.1</b> Statistical Function Dictionary</a></li>
<li class="chapter" data-level="11.2" data-path="basic-statistics.html"><a href="basic-statistics.html#basic-statistics-in-r"><i class="fa fa-check"></i><b>11.2</b> Basic Statistics in R</a><ul>
<li class="chapter" data-level="11.2.1" data-path="basic-statistics.html"><a href="basic-statistics.html#load-willow-creek-data"><i class="fa fa-check"></i><b>11.2.1</b> Load Willow Creek data</a></li>
<li class="chapter" data-level="11.2.2" data-path="basic-statistics.html"><a href="basic-statistics.html#subsetting-data"><i class="fa fa-check"></i><b>11.2.2</b> Subsetting Data</a></li>
<li class="chapter" data-level="11.2.3" data-path="basic-statistics.html"><a href="basic-statistics.html#trends-and-distributions"><i class="fa fa-check"></i><b>11.2.3</b> Trends and Distributions</a></li>
<li class="chapter" data-level="11.2.4" data-path="basic-statistics.html"><a href="basic-statistics.html#finding-a-best-fit-distribution"><i class="fa fa-check"></i><b>11.2.4</b> Finding a Best-Fit Distribution</a></li>
<li class="chapter" data-level="11.2.5" data-path="basic-statistics.html"><a href="basic-statistics.html#correlation-plots"><i class="fa fa-check"></i><b>11.2.5</b> Correlation Plots</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="basic-statistics.html"><a href="basic-statistics.html#assignment-4"><i class="fa fa-check"></i><b>11.3</b> Assignment</a><ul>
<li class="chapter" data-level="11.3.1" data-path="basic-statistics.html"><a href="basic-statistics.html#extra-credit---2-points"><i class="fa fa-check"></i><b>11.3.1</b> Extra Credit - 2 points</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html"><i class="fa fa-check"></i><b>12</b> Plotting with <code>ggplot2</code></a><ul>
<li class="chapter" data-level="12.1" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html#ggplot2-with-willow-creek-meteorological-data"><i class="fa fa-check"></i><b>12.1</b> ggplot2 with Willow Creek Meteorological Data</a></li>
<li class="chapter" data-level="12.2" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html#assignment-5"><i class="fa fa-check"></i><b>12.2</b> Assignment:</a></li>
<li class="chapter" data-level="12.3" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html#extra-credit---2-points-1"><i class="fa fa-check"></i><b>12.3</b> Extra Credit - 2 Points</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="spatial-plots-with-ggplot2.html"><a href="spatial-plots-with-ggplot2.html"><i class="fa fa-check"></i><b>13</b> Spatial Plots with <code>ggplot2</code></a><ul>
<li class="chapter" data-level="13.1" data-path="spatial-plots-with-ggplot2.html"><a href="spatial-plots-with-ggplot2.html#simple-features"><i class="fa fa-check"></i><b>13.1</b> Simple Features</a></li>
<li class="chapter" data-level="13.2" data-path="spatial-plots-with-ggplot2.html"><a href="spatial-plots-with-ggplot2.html#sea-surface-temperature-ggplot"><i class="fa fa-check"></i><b>13.2</b> Sea Surface Temperature ggplot</a></li>
<li class="chapter" data-level="13.3" data-path="spatial-plots-with-ggplot2.html"><a href="spatial-plots-with-ggplot2.html#r-color-brewer-palettes"><i class="fa fa-check"></i><b>13.3</b> R Color Brewer Palettes</a><ul>
<li class="chapter" data-level="13.3.1" data-path="spatial-plots-with-ggplot2.html"><a href="spatial-plots-with-ggplot2.html#multi-plot-ggplot"><i class="fa fa-check"></i><b>13.3.1</b> Multi Plot ggplot</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="spatial-plots-with-ggplot2.html"><a href="spatial-plots-with-ggplot2.html#assignment-6"><i class="fa fa-check"></i><b>13.4</b> Assignment</a><ul>
<li class="chapter" data-level="13.4.1" data-path="spatial-plots-with-ggplot2.html"><a href="spatial-plots-with-ggplot2.html#extra-credit---2-points-2"><i class="fa fa-check"></i><b>13.4.1</b> Extra Credit - 2 Points</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="shapefiles.html"><a href="shapefiles.html"><i class="fa fa-check"></i><b>14</b> Shapefiles</a><ul>
<li class="chapter" data-level="14.1" data-path="shapefiles.html"><a href="shapefiles.html#reading-in-shapefiles"><i class="fa fa-check"></i><b>14.1</b> Reading in Shapefiles</a></li>
<li class="chapter" data-level="14.2" data-path="shapefiles.html"><a href="shapefiles.html#combining-shapefiles-with-data"><i class="fa fa-check"></i><b>14.2</b> Combining Shapefiles with Data</a></li>
<li class="chapter" data-level="14.3" data-path="shapefiles.html"><a href="shapefiles.html#visualizing-the-shapefiles-data"><i class="fa fa-check"></i><b>14.3</b> Visualizing the Shapefiles &amp; Data</a></li>
<li class="chapter" data-level="14.4" data-path="shapefiles.html"><a href="shapefiles.html#saving-a-shapefile"><i class="fa fa-check"></i><b>14.4</b> Saving a shapefile</a></li>
<li class="chapter" data-level="14.5" data-path="shapefiles.html"><a href="shapefiles.html#assignment-7"><i class="fa fa-check"></i><b>14.5</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="remote-data-extraction.html"><a href="remote-data-extraction.html"><i class="fa fa-check"></i><b>15</b> Remote Data Extraction</a><ul>
<li class="chapter" data-level="15.1" data-path="remote-data-extraction.html"><a href="remote-data-extraction.html#thredds"><i class="fa fa-check"></i><b>15.1</b> THREDDS</a></li>
<li class="chapter" data-level="15.2" data-path="remote-data-extraction.html"><a href="remote-data-extraction.html#erddap"><i class="fa fa-check"></i><b>15.2</b> ERDDAP</a><ul>
<li class="chapter" data-level="15.2.1" data-path="remote-data-extraction.html"><a href="remote-data-extraction.html#finding-the-data-you-want"><i class="fa fa-check"></i><b>15.2.1</b> Finding the Data You Want</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="remote-data-extraction.html"><a href="remote-data-extraction.html#assignment-8"><i class="fa fa-check"></i><b>15.3</b> Assignment</a><ul>
<li class="chapter" data-level="15.3.1" data-path="remote-data-extraction.html"><a href="remote-data-extraction.html#extra-credit---2-points-3"><i class="fa fa-check"></i><b>15.3.1</b> Extra Credit - 2 Points</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="functions-and-code-presentation.html"><a href="functions-and-code-presentation.html"><i class="fa fa-check"></i><b>16</b> Functions and Code Presentation</a><ul>
<li class="chapter" data-level="16.1" data-path="functions-and-code-presentation.html"><a href="functions-and-code-presentation.html#functions"><i class="fa fa-check"></i><b>16.1</b> Functions</a></li>
<li class="chapter" data-level="16.2" data-path="functions-and-code-presentation.html"><a href="functions-and-code-presentation.html#netcdf-processing-function"><i class="fa fa-check"></i><b>16.2</b> NetCDF Processing Function</a></li>
<li class="chapter" data-level="16.3" data-path="functions-and-code-presentation.html"><a href="functions-and-code-presentation.html#functions-in-for-loops"><i class="fa fa-check"></i><b>16.3</b> Functions in For Loops</a></li>
<li class="chapter" data-level="16.4" data-path="functions-and-code-presentation.html"><a href="functions-and-code-presentation.html#rmarkdown"><i class="fa fa-check"></i><b>16.4</b> RMarkdown</a></li>
<li class="chapter" data-level="16.5" data-path="functions-and-code-presentation.html"><a href="functions-and-code-presentation.html#assignment-9"><i class="fa fa-check"></i><b>16.5</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="machine-learning-with-r.html"><a href="machine-learning-with-r.html"><i class="fa fa-check"></i><b>17</b> Machine Learning with R</a><ul>
<li class="chapter" data-level="17.1" data-path="machine-learning-with-r.html"><a href="machine-learning-with-r.html#machine-learning-terms"><i class="fa fa-check"></i><b>17.1</b> Machine Learning Terms</a></li>
<li class="chapter" data-level="17.2" data-path="machine-learning-with-r.html"><a href="machine-learning-with-r.html#classical-machine-learning"><i class="fa fa-check"></i><b>17.2</b> Classical Machine Learning</a><ul>
<li class="chapter" data-level="17.2.1" data-path="machine-learning-with-r.html"><a href="machine-learning-with-r.html#supervised-learning"><i class="fa fa-check"></i><b>17.2.1</b> Supervised Learning</a></li>
<li class="chapter" data-level="17.2.2" data-path="machine-learning-with-r.html"><a href="machine-learning-with-r.html#unsupervised-learning"><i class="fa fa-check"></i><b>17.2.2</b> Unsupervised Learning</a></li>
<li class="chapter" data-level="17.2.3" data-path="machine-learning-with-r.html"><a href="machine-learning-with-r.html#neural-networks"><i class="fa fa-check"></i><b>17.2.3</b> Neural Networks</a></li>
<li class="chapter" data-level="17.2.4" data-path="machine-learning-with-r.html"><a href="machine-learning-with-r.html#reinforcement-learning"><i class="fa fa-check"></i><b>17.2.4</b> Reinforcement Learning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html"><i class="fa fa-check"></i><b>18</b> Time Series Forecasting</a><ul>
<li class="chapter" data-level="18.1" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#load-the-packages-and-data"><i class="fa fa-check"></i><b>18.1</b> Load the Packages and Data</a></li>
<li class="chapter" data-level="18.2" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#aggregate-data"><i class="fa fa-check"></i><b>18.2</b> Aggregate Data</a></li>
<li class="chapter" data-level="18.3" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#prepping-the-model"><i class="fa fa-check"></i><b>18.3</b> Prepping the Model</a></li>
<li class="chapter" data-level="18.4" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#running-the-model"><i class="fa fa-check"></i><b>18.4</b> Running the Model</a></li>
<li class="chapter" data-level="18.5" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#validation-and-accuracy"><i class="fa fa-check"></i><b>18.5</b> Validation and Accuracy</a></li>
<li class="chapter" data-level="18.6" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#future-forecasting"><i class="fa fa-check"></i><b>18.6</b> Future Forecasting</a></li>
<li class="chapter" data-level="18.7" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#assignment-10"><i class="fa fa-check"></i><b>18.7</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html"><i class="fa fa-check"></i><b>19</b> Random Forest Modeling</a><ul>
<li class="chapter" data-level="19.1" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#prepare-the-data"><i class="fa fa-check"></i><b>19.1</b> Prepare the Data</a></li>
<li class="chapter" data-level="19.2" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#dimensionality-reduction"><i class="fa fa-check"></i><b>19.2</b> Dimensionality Reduction</a><ul>
<li class="chapter" data-level="19.2.1" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#principal-component-analysis"><i class="fa fa-check"></i><b>19.2.1</b> Principal Component Analysis</a></li>
<li class="chapter" data-level="19.2.2" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#t-sne-dimensionality-reduction"><i class="fa fa-check"></i><b>19.2.2</b> t-SNE Dimensionality Reduction</a></li>
<li class="chapter" data-level="19.2.3" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#multidimensional-scaling"><i class="fa fa-check"></i><b>19.2.3</b> Multidimensional Scaling</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#random-forests"><i class="fa fa-check"></i><b>19.3</b> Random Forests</a><ul>
<li class="chapter" data-level="19.3.1" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#decision-trees"><i class="fa fa-check"></i><b>19.3.1</b> Decision Trees</a></li>
<li class="chapter" data-level="19.3.2" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#data-partition"><i class="fa fa-check"></i><b>19.3.2</b> Data Partition</a></li>
<li class="chapter" data-level="19.3.3" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#training-the-model"><i class="fa fa-check"></i><b>19.3.3</b> Training the Model</a></li>
<li class="chapter" data-level="19.3.4" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#testing-the-model"><i class="fa fa-check"></i><b>19.3.4</b> Testing the Model</a></li>
<li class="chapter" data-level="19.3.5" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#hyperparameter-tuning"><i class="fa fa-check"></i><b>19.3.5</b> Hyperparameter Tuning</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="random-forest-modeling.html"><a href="random-forest-modeling.html#assignment-11"><i class="fa fa-check"></i><b>19.4</b> Assignment</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/jsimkins2" target="blank">James Simkins</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Geospatial Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="random-forest-modeling" class="section level1">
<h1><span class="header-section-number">19</span> Random Forest Modeling</h1>
<p><img src="images/randomForest.png" width="80%" style="display: block; margin: auto;" /></p>
<p>In this tutorial, we’ll explore feature engineering, training and test splitting, and model selecting with random forests. We’ll introduce the <code>caret</code> package, a popular R package with machine learning tools. The dataset we’ll be using is called <code>Bejaia_ForestFires.csv</code> and contains information regarding forest fire conditions in Algeria. We are going to use machine learning practices to extract trends from the dataset and attempt to predict whether a forest fire will occur on a particular day given environmental conditions. Here are the variables within the dataset:</p>
<p><strong>Weather Observations</strong></p>
<dl>
<dt>Date</dt>
<dd>Day, month (‘june’ to ‘september’) for the year 2012
</dd>
<dt>Temp</dt>
<dd>Max daily temperature in degrees Celsius: 22 to 42
</dd>
<dt>RH</dt>
<dd>Relative Humidity in %: 21 to 90
</dd>
<dt>Ws</dt>
<dd>Wind speed in km/h: 6 to 29
</dd>
<dt>Rain</dt>
<dd>Total daily precip in mm: 0 to 16.8
</dd>
</dl>
<p><strong>Fire Weather Indices</strong></p>
<dl>
<dt>FFMC</dt>
<dd>Fine Fuel Moisture Code index from the FWI system: 28.6 to 92.5
</dd>
<dt>DMC</dt>
<dd>Duff Moisture Code index from the FWI system: 1.1 to 65.9
</dd>
<dt>DC</dt>
<dd>Drought Code index from the FWI system: 7 to 220.4
</dd>
<dt>ISI</dt>
<dd>Initial Spread Index from the FWI system: 0 to 18.5
</dd>
<dt>BUI</dt>
<dd>Buildup Index from the FWI system: 1.1 to 68
</dd>
<dt>FWI</dt>
<dd>Class Weather Index : 0 to 31.1
</dd>
</dl>
<p><strong>Class Component</strong></p>
<p>Class : Forest Fire presence (fire) or absence (no fire)</p>
<div id="prepare-the-data" class="section level2">
<h2><span class="header-section-number">19.1</span> Prepare the Data</h2>
<p>The <code>Bejaia_ForestFires.csv</code> dataset is located in the course datasets folder. Let’s open it and plot the Forest Fire presence/absence (the <code>Class</code> variable).</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb539-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb539-2" data-line-number="2"><span class="kw">library</span>(tibble)</a>
<a class="sourceLine" id="cb539-3" data-line-number="3">ff_data =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/Users/james/Documents/Github/geog473-673/datasets/Bejaia_ForestFires.csv&quot;</span>)</a>
<a class="sourceLine" id="cb539-4" data-line-number="4">ff_data =<span class="st"> </span><span class="kw">as.tibble</span>(ff_data)</a>
<a class="sourceLine" id="cb539-5" data-line-number="5"><span class="co"># response variable used for classification</span></a>
<a class="sourceLine" id="cb539-6" data-line-number="6"><span class="kw">ggplot</span>(ff_data, <span class="kw">aes</span>(<span class="dt">x =</span> Class, <span class="dt">fill =</span> Class)) <span class="op">+</span></a>
<a class="sourceLine" id="cb539-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_bar</span>()</a></code></pre></div>
<p><img src="R_Geospatial_Sciences_files/figure-html/unnamed-chunk-217-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>Now, let’s use the <code>gather</code> function from the <code>tidyverse</code> to evaluate each variable against the Class (aka Fire or No Fire). Once we have our <code>gathered</code> data frame, let’s show a density plot for each variable.</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb540-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb540-2" data-line-number="2">gathered =<span class="st"> </span><span class="kw">gather</span>(ff_data, x, y, day<span class="op">:</span>FWI)</a>
<a class="sourceLine" id="cb540-3" data-line-number="3"></a>
<a class="sourceLine" id="cb540-4" data-line-number="4"><span class="kw">ggplot</span>(<span class="dt">data =</span> gathered, <span class="kw">aes</span>(<span class="dt">x =</span> y, <span class="dt">color =</span> Class, <span class="dt">fill =</span> Class)) <span class="op">+</span></a>
<a class="sourceLine" id="cb540-5" data-line-number="5"><span class="st">    </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb540-6" data-line-number="6"><span class="st">    </span><span class="kw">facet_wrap</span>( <span class="op">~</span><span class="st"> </span>x, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="R_Geospatial_Sciences_files/figure-html/unnamed-chunk-218-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="dimensionality-reduction" class="section level2">
<h2><span class="header-section-number">19.2</span> Dimensionality Reduction</h2>
<p>Sometimes datasets contain too many variables and evaluating which are important can be difficult. Fortunately, there are statistical methods we can use in R to reduce the number of dimensions to retain only the high impact variables.</p>
<div id="principal-component-analysis" class="section level3">
<h3><span class="header-section-number">19.2.1</span> Principal Component Analysis</h3>
<p>Principal Component Analysis (PCA) is a popular statistical method that uses correlations and covariances between variables to reduce data that contains <em>many</em> variables. PCA projects the data with fewer dimensions (aka the principal components) using linear combinations across the dataset variables. The dimensions (principal components) are ordered from most explained variance to least explained variance (of the original variables). Principal component analysis can also reveal important features of the data such as outliers and departures from a multinormal distribution. First, we’ll need to cut out the Fire Weather Indices of our dataset. These are calculated based on environmental conditions and are used to help predict forest fires. We’re going to remove these and attempt to create new methods for predicting whether there will be a forest fire or not.</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb541-1" data-line-number="1"><span class="kw">library</span>(ellipse)</a>
<a class="sourceLine" id="cb541-2" data-line-number="2"></a>
<a class="sourceLine" id="cb541-3" data-line-number="3"><span class="co"># create dataframe with only weather variables - turn Class variable into a factor then turn it into numeric so we can run prcomp</span></a>
<a class="sourceLine" id="cb541-4" data-line-number="4">cutdata =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Temperature =</span> ff_data<span class="op">$</span>Temperature, <span class="dt">Rain =</span> ff_data<span class="op">$</span>Rain, <span class="dt">RH =</span> ff_data<span class="op">$</span>RH, <span class="dt">Ws =</span> ff_data<span class="op">$</span>Ws, <span class="dt">Class =</span> <span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(ff_data<span class="op">$</span>Class)))</a>
<a class="sourceLine" id="cb541-5" data-line-number="5"><span class="kw">head</span>(cutdata)</a></code></pre></div>
<pre><code>##   Temperature Rain RH Ws Class
## 1          29  0.0 57 18     2
## 2          29  1.3 61 13     2
## 3          26 13.1 82 22     2
## 4          25  2.5 89 13     2
## 5          27  0.0 77 16     2
## 6          31  0.0 67 14     1</code></pre>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb543-1" data-line-number="1"><span class="co"># perform pca using prcomp and extract scores </span></a>
<a class="sourceLine" id="cb543-2" data-line-number="2">pcaOutput &lt;-<span class="st"> </span><span class="kw">prcomp</span>(<span class="kw">as.matrix</span>(cutdata), <span class="dt">scale =</span> <span class="ot">TRUE</span>, <span class="dt">center =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb543-3" data-line-number="3">pcaOutput</a></code></pre></div>
<pre><code>## Standard deviations (1, .., p=5):
## [1] 1.5839583 0.9756049 0.8161873 0.7594599 0.5443622
## 
## Rotation (n x k) = (5 x 5):
##                    PC1        PC2        PC3         PC4         PC5
## Temperature  0.5424264 -0.2172267 -0.1829743  0.18263364 -0.76925388
## Rain        -0.4447857 -0.3014978 -0.5223649 -0.61317843 -0.24982364
## RH          -0.4889724  0.1941107  0.6351261 -0.05239005 -0.56311381
## Ws          -0.2986886 -0.8190447  0.1429360  0.45867885  0.09557101
## Class       -0.4238282  0.3916610 -0.5194607  0.61443158 -0.14002013</code></pre>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb545-1" data-line-number="1"><span class="co"># create separate dataframe</span></a>
<a class="sourceLine" id="cb545-2" data-line-number="2">pcaOutput2 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(pcaOutput<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb545-3" data-line-number="3">  </a>
<a class="sourceLine" id="cb545-4" data-line-number="4"><span class="co"># add Class as variable for the groups</span></a>
<a class="sourceLine" id="cb545-5" data-line-number="5">pcaOutput2<span class="op">$</span>groups &lt;-<span class="st"> </span>ff_data<span class="op">$</span>Class </a>
<a class="sourceLine" id="cb545-6" data-line-number="6"></a>
<a class="sourceLine" id="cb545-7" data-line-number="7"><span class="co"># calculate centroids of PC1 and PC2</span></a>
<a class="sourceLine" id="cb545-8" data-line-number="8">centroids &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">cbind</span>(PC1, PC2) <span class="op">~</span><span class="st"> </span>groups, pcaOutput2, mean)</a>
<a class="sourceLine" id="cb545-9" data-line-number="9"></a>
<a class="sourceLine" id="cb545-10" data-line-number="10"><span class="co"># calculate 95% confidence ellipsoids so we can plot these polygons over ggplot</span></a>
<a class="sourceLine" id="cb545-11" data-line-number="11">conf.rgn  &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, <span class="kw">lapply</span>(<span class="kw">unique</span>(pcaOutput2<span class="op">$</span>groups), <span class="cf">function</span>(t)</a>
<a class="sourceLine" id="cb545-12" data-line-number="12">  <span class="kw">data.frame</span>(<span class="dt">groups =</span> <span class="kw">as.character</span>(t),</a>
<a class="sourceLine" id="cb545-13" data-line-number="13">             <span class="kw">ellipse</span>(<span class="kw">cov</span>(pcaOutput2[pcaOutput2<span class="op">$</span>groups <span class="op">==</span><span class="st"> </span>t, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]),</a>
<a class="sourceLine" id="cb545-14" data-line-number="14">                   <span class="dt">centre =</span> <span class="kw">as.matrix</span>(centroids[centroids<span class="op">$</span>groups <span class="op">==</span><span class="st"> </span>t, <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]),</a>
<a class="sourceLine" id="cb545-15" data-line-number="15">                   <span class="dt">level =</span> <span class="fl">0.95</span>),</a>
<a class="sourceLine" id="cb545-16" data-line-number="16">             <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)))</a>
<a class="sourceLine" id="cb545-17" data-line-number="17"></a>
<a class="sourceLine" id="cb545-18" data-line-number="18"><span class="co"># Plot PC1 and PC2</span></a>
<a class="sourceLine" id="cb545-19" data-line-number="19"><span class="kw">ggplot</span>(<span class="dt">data =</span> pcaOutput2, <span class="kw">aes</span>(<span class="dt">x =</span> PC1, <span class="dt">y =</span> PC2, <span class="dt">group =</span> <span class="kw">as.factor</span>(groups), <span class="dt">color =</span> <span class="kw">as.factor</span>(groups))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb545-20" data-line-number="20"><span class="st">    </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> conf.rgn, <span class="kw">aes</span>(<span class="dt">fill =</span> groups), <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb545-21" data-line-number="21"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb545-22" data-line-number="22"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Principal Component Analysis of Bejaia Forest Fires: PC1 and PC2&quot;</span>)</a></code></pre></div>
<p><img src="R_Geospatial_Sciences_files/figure-html/unnamed-chunk-219-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="t-sne-dimensionality-reduction" class="section level3">
<h3><span class="header-section-number">19.2.2</span> t-SNE Dimensionality Reduction</h3>
<p>TSNE Dimensionality Reduction removes redundant information and preserves high impact information within a dataset. TSNE is similar to PCA with the main difference being that TSNE retains nonlinear variance. First, we’ll calculate a proximity matrix of our <code>ff_data</code> dataframe using the <code>dist</code> function. This function will calculate the relative distances (euclidean) between the rows of the dataset. Then, we’ll use the <code>tsne</code> function from the <code>tsne</code> package.</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb546-1" data-line-number="1"><span class="kw">library</span>(tsne)</a>
<a class="sourceLine" id="cb546-2" data-line-number="2"></a>
<a class="sourceLine" id="cb546-3" data-line-number="3">sne_data =<span class="st"> </span><span class="kw">dist</span>(ff_data)</a>
<a class="sourceLine" id="cb546-4" data-line-number="4">sne_data =<span class="st"> </span><span class="kw">tsne</span>(sne_data)</a>
<a class="sourceLine" id="cb546-5" data-line-number="5">sne_data =<span class="st"> </span><span class="kw">as.data.frame</span>(sne_data)</a>
<a class="sourceLine" id="cb546-6" data-line-number="6">sne_data<span class="op">$</span>Class =<span class="st"> </span>ff_data<span class="op">$</span>Class</a>
<a class="sourceLine" id="cb546-7" data-line-number="7"></a>
<a class="sourceLine" id="cb546-8" data-line-number="8"><span class="kw">ggplot</span>(<span class="dt">data =</span> sne_data, <span class="kw">aes</span>(<span class="dt">x =</span> V1, <span class="dt">y =</span> V2, <span class="dt">color =</span> Class)) <span class="op">+</span></a>
<a class="sourceLine" id="cb546-9" data-line-number="9"><span class="st">    </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="R_Geospatial_Sciences_files/figure-html/unnamed-chunk-220-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="multidimensional-scaling" class="section level3">
<h3><span class="header-section-number">19.2.3</span> Multidimensional Scaling</h3>
<p>Multidimensional scaling (MDS) is a technique that creates a map displaying the relative positions of a number of objects, given only a table of the distances between them. It flows similarly to TSNE in R but instead of using <code>tsne</code> we’ll be using <code>cmdscale</code> to perform classical multidimensional scaling based on the proximity matrix.</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb547-1" data-line-number="1"><span class="co"># create proximity matrix</span></a>
<a class="sourceLine" id="cb547-2" data-line-number="2">prox =<span class="st"> </span><span class="kw">dist</span>(ff_data)</a>
<a class="sourceLine" id="cb547-3" data-line-number="3"><span class="co"># perform mds</span></a>
<a class="sourceLine" id="cb547-4" data-line-number="4">m_scale =<span class="st"> </span><span class="kw">cmdscale</span>(prox)</a>
<a class="sourceLine" id="cb547-5" data-line-number="5">m_scale =<span class="st"> </span><span class="kw">as.data.frame</span>(m_scale)</a>
<a class="sourceLine" id="cb547-6" data-line-number="6"><span class="co"># add the class variable back in</span></a>
<a class="sourceLine" id="cb547-7" data-line-number="7">m_scale<span class="op">$</span>Class =<span class="st"> </span>ff_data<span class="op">$</span>Class</a>
<a class="sourceLine" id="cb547-8" data-line-number="8"></a>
<a class="sourceLine" id="cb547-9" data-line-number="9"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb547-10" data-line-number="10"><span class="kw">ggplot</span>(<span class="dt">data =</span> m_scale,<span class="kw">aes</span>(<span class="dt">x =</span> V1, <span class="dt">y =</span> V2, <span class="dt">color =</span> Class)) <span class="op">+</span></a>
<a class="sourceLine" id="cb547-11" data-line-number="11"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb547-12" data-line-number="12"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&#39;Multidimensional Scaling of Bejaia Forest Fire Data&#39;</span>)</a></code></pre></div>
<p><img src="R_Geospatial_Sciences_files/figure-html/unnamed-chunk-221-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="random-forests" class="section level2">
<h2><span class="header-section-number">19.3</span> Random Forests</h2>
<p>Random Forest is a machine learning method for classification or regression predictions. These predictions are based on the generation of multiple decision trees trees. Decision trees serve as the building block for random forests. The <code>caret</code> package is a popular machine learning package in R that can be used to create random forest models. Our goal is to create a random forest model that predicts the presence/absence of a forest fire given environmental conditions.</p>
<div id="decision-trees" class="section level3">
<h3><span class="header-section-number">19.3.1</span> Decision Trees</h3>
<p>Classification in R can be done using the <code>rpart</code> and <code>rpart.plot</code> packages. These can be used to calculate and show decision trees (aka classification trees) for a given scenario. In our case, we’ll calculate and plot the decision tree for whether or not there is a forest fire. Before we proceed, when we calculate random values going into a model in R, it’s good practice to use the <code>set.seed()</code> function. The <code>set.seed()</code> function sets the starting number used to generate a sequence of random numbers – it ensures that you get the same result if you start with that same seed each time you run the same process.</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb548-1" data-line-number="1"><span class="kw">library</span>(rpart)</a>
<a class="sourceLine" id="cb548-2" data-line-number="2"><span class="kw">library</span>(rpart.plot)</a>
<a class="sourceLine" id="cb548-3" data-line-number="3"><span class="kw">library</span>(caret)</a>
<a class="sourceLine" id="cb548-4" data-line-number="4"></a>
<a class="sourceLine" id="cb548-5" data-line-number="5"><span class="co"># cut the data but htis time preserve &#39;Fire&#39; and &#39;No Fire&#39; characters of the ff_data$Class</span></a>
<a class="sourceLine" id="cb548-6" data-line-number="6">cutdata =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Temperature =</span> ff_data<span class="op">$</span>Temperature, <span class="dt">Rain =</span> ff_data<span class="op">$</span>Rain, <span class="dt">RH =</span> ff_data<span class="op">$</span>RH, <span class="dt">Ws =</span> ff_data<span class="op">$</span>Ws, <span class="dt">Class =</span> ff_data<span class="op">$</span>Class)</a>
<a class="sourceLine" id="cb548-7" data-line-number="7">cutdata<span class="op">$</span>Class =<span class="st"> </span><span class="kw">as.factor</span>(cutdata<span class="op">$</span>Class)</a>
<a class="sourceLine" id="cb548-8" data-line-number="8"></a>
<a class="sourceLine" id="cb548-9" data-line-number="9"><span class="co"># now that it&#39;s a factor, we need to redefine the levels again</span></a>
<a class="sourceLine" id="cb548-10" data-line-number="10"><span class="kw">levels</span>(cutdata<span class="op">$</span>Class) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Fire&quot;</span>, <span class="st">&quot;No Fire&quot;</span>)</a>
<a class="sourceLine" id="cb548-11" data-line-number="11"></a>
<a class="sourceLine" id="cb548-12" data-line-number="12"><span class="co"># set the seed</span></a>
<a class="sourceLine" id="cb548-13" data-line-number="13"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb548-14" data-line-number="14"><span class="co"># calculate the rpart model</span></a>
<a class="sourceLine" id="cb548-15" data-line-number="15">fit &lt;-<span class="st"> </span><span class="kw">rpart</span>(Class <span class="op">~</span><span class="st"> </span>.,</a>
<a class="sourceLine" id="cb548-16" data-line-number="16">            <span class="dt">data =</span> cutdata,</a>
<a class="sourceLine" id="cb548-17" data-line-number="17">            <span class="dt">method =</span> <span class="st">&quot;class&quot;</span>,</a>
<a class="sourceLine" id="cb548-18" data-line-number="18">            <span class="dt">control =</span> <span class="kw">rpart.control</span>(<span class="dt">xval =</span> <span class="dv">10</span>, </a>
<a class="sourceLine" id="cb548-19" data-line-number="19">                                    <span class="dt">minbucket =</span> <span class="dv">2</span>, </a>
<a class="sourceLine" id="cb548-20" data-line-number="20">                                    <span class="dt">cp =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb548-21" data-line-number="21">             <span class="dt">parms =</span> <span class="kw">list</span>(<span class="dt">split =</span> <span class="st">&quot;information&quot;</span>))</a>
<a class="sourceLine" id="cb548-22" data-line-number="22"></a>
<a class="sourceLine" id="cb548-23" data-line-number="23"><span class="co"># plot the fit!</span></a>
<a class="sourceLine" id="cb548-24" data-line-number="24"><span class="kw">rpart.plot</span>(fit, <span class="dt">extra =</span> <span class="dv">100</span>)</a></code></pre></div>
<p><img src="R_Geospatial_Sciences_files/figure-html/unnamed-chunk-222-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="data-partition" class="section level3">
<h3><span class="header-section-number">19.3.2</span> Data Partition</h3>
<p>The goal of this exercise is to predict the presence/absence of a forest fire given environmental conditions. We’ll need to provide the model with a training dataset to learn from and a test dataset to test itself against. This can be done using <code>createDataPartition</code> from the <code>caret</code> package. Then, let’s calculate a correlation matrix using <code>corrplot</code>.</p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb549-1" data-line-number="1"><span class="co"># set the seed</span></a>
<a class="sourceLine" id="cb549-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb549-3" data-line-number="3"><span class="co"># create test and train datasets</span></a>
<a class="sourceLine" id="cb549-4" data-line-number="4">index &lt;-<span class="st"> </span><span class="kw">createDataPartition</span>(<span class="kw">as.factor</span>(cutdata<span class="op">$</span>Class), <span class="dt">p =</span> <span class="fl">0.7</span>, <span class="dt">list =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb549-5" data-line-number="5">train_data &lt;-<span class="st"> </span>cutdata[index, ]</a>
<a class="sourceLine" id="cb549-6" data-line-number="6">test_data  &lt;-<span class="st"> </span>cutdata[<span class="op">-</span>index, ]</a>
<a class="sourceLine" id="cb549-7" data-line-number="7"></a>
<a class="sourceLine" id="cb549-8" data-line-number="8"><span class="kw">library</span>(corrplot)</a>
<a class="sourceLine" id="cb549-9" data-line-number="9"></a>
<a class="sourceLine" id="cb549-10" data-line-number="10"><span class="co"># calculate correlation matrix</span></a>
<a class="sourceLine" id="cb549-11" data-line-number="11">num_train_data =<span class="st"> </span>train_data</a>
<a class="sourceLine" id="cb549-12" data-line-number="12">num_train_data<span class="op">$</span>Class =<span class="st"> </span><span class="kw">as.numeric</span>(num_train_data<span class="op">$</span>Class)</a>
<a class="sourceLine" id="cb549-13" data-line-number="13">corMatMy &lt;-<span class="st"> </span><span class="kw">cor</span>(num_train_data)</a>
<a class="sourceLine" id="cb549-14" data-line-number="14"><span class="kw">corrplot</span>(corMatMy, <span class="dt">order =</span> <span class="st">&quot;hclust&quot;</span>)</a></code></pre></div>
<p><img src="R_Geospatial_Sciences_files/figure-html/unnamed-chunk-223-1.png" width="50%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb550-1" data-line-number="1">highlyCor &lt;-<span class="st"> </span><span class="kw">colnames</span>(train_data)[<span class="kw">findCorrelation</span>(corMatMy, <span class="dt">cutoff =</span> <span class="fl">0.7</span>, <span class="dt">verbose =</span> <span class="ot">TRUE</span>)]</a></code></pre></div>
<pre><code>## All correlations &lt;= 0.7</code></pre>
</div>
<div id="training-the-model" class="section level3">
<h3><span class="header-section-number">19.3.3</span> Training the Model</h3>
<p>Now, let’s use our training dataset to train a model using random forest methods. Remember, we’re training our model to predict the <code>Class</code> variable (i.e. Fire vs No Fire) based on the other variables (temperature, relative humidity, etc.)</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb552-1" data-line-number="1"><span class="co"># set the seed</span></a>
<a class="sourceLine" id="cb552-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb552-3" data-line-number="3"></a>
<a class="sourceLine" id="cb552-4" data-line-number="4"><span class="co"># create the model</span></a>
<a class="sourceLine" id="cb552-5" data-line-number="5">model_rf &lt;-<span class="st"> </span>caret<span class="op">::</span><span class="kw">train</span>(Class <span class="op">~</span><span class="st"> </span>.,</a>
<a class="sourceLine" id="cb552-6" data-line-number="6">                         <span class="dt">data =</span> train_data,</a>
<a class="sourceLine" id="cb552-7" data-line-number="7">                         <span class="dt">method =</span> <span class="st">&quot;rf&quot;</span>,</a>
<a class="sourceLine" id="cb552-8" data-line-number="8">                         <span class="dt">preProcess =</span> <span class="kw">c</span>(<span class="st">&quot;scale&quot;</span>, <span class="st">&quot;center&quot;</span>),</a>
<a class="sourceLine" id="cb552-9" data-line-number="9">                         <span class="dt">trControl =</span> <span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, </a>
<a class="sourceLine" id="cb552-10" data-line-number="10">                                                  <span class="dt">number =</span> <span class="dv">5</span>, </a>
<a class="sourceLine" id="cb552-11" data-line-number="11">                                                  <span class="dt">repeats =</span> <span class="dv">3</span>, </a>
<a class="sourceLine" id="cb552-12" data-line-number="12">                                                  <span class="dt">savePredictions =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb552-13" data-line-number="13">                                                  <span class="dt">verboseIter =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb552-14" data-line-number="14"></a>
<a class="sourceLine" id="cb552-15" data-line-number="15"><span class="co"># print the random forest model output </span></a>
<a class="sourceLine" id="cb552-16" data-line-number="16">model_rf</a></code></pre></div>
<pre><code>## Random Forest 
## 
## 87 samples
##  4 predictor
##  2 classes: &#39;Fire&#39;, &#39;No Fire&#39; 
## 
## Pre-processing: scaled (4), centered (4) 
## Resampling: Cross-Validated (5 fold, repeated 3 times) 
## Summary of sample sizes: 70, 70, 69, 70, 69, 69, ... 
## Resampling results across tuning parameters:
## 
##   mtry  Accuracy   Kappa    
##   2     0.8082789  0.6159185
##   3     0.8198257  0.6380856
##   4     0.8274510  0.6524226
## 
## Accuracy was used to select the optimal model using the largest value.
## The final value used for the model was mtry = 4.</code></pre>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb554-1" data-line-number="1"><span class="co"># print out the confusion matrix </span></a>
<a class="sourceLine" id="cb554-2" data-line-number="2">model_rf<span class="op">$</span>finalModel<span class="op">$</span>confusion</a></code></pre></div>
<pre><code>##         Fire No Fire class.error
## Fire      34       8   0.1904762
## No Fire    8      37   0.1777778</code></pre>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb556-1" data-line-number="1"><span class="co"># plot variable importance of the model</span></a>
<a class="sourceLine" id="cb556-2" data-line-number="2">importance &lt;-<span class="st"> </span><span class="kw">varImp</span>(model_rf, <span class="dt">scale =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb556-3" data-line-number="3"><span class="kw">plot</span>(importance)</a></code></pre></div>
<p><img src="R_Geospatial_Sciences_files/figure-html/unnamed-chunk-224-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>Rain is the most important variable for the presence/absence of forest fires. Relative Humidity and Temperature carry importance but not as much as Rain. Wind Speed doesn’t seem to be all that important.</p>
</div>
<div id="testing-the-model" class="section level3">
<h3><span class="header-section-number">19.3.4</span> Testing the Model</h3>
<p>In order to test our Random Forest model, <code>model_rf</code>, we’ll need to use a confusion matrix. A Confusion matrix is a matrix used for evaluating the performance of a classification model. The matrix compares the actual target values (the testing data class) with those predicted by <code>model_rf</code>. This gives us a holistic view of how well our random forest model is performing and shows what kinds of errors it is making. After we get some statistics from the confusino matrix, well need to run the model using the <code>predict</code> function on the <code>test_data</code>.</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb557-1" data-line-number="1"><span class="co"># Calculate the confusion matrix</span></a>
<a class="sourceLine" id="cb557-2" data-line-number="2"><span class="kw">confusionMatrix</span>(<span class="kw">predict</span>(model_rf, test_data), <span class="kw">as.factor</span>(test_data<span class="op">$</span>Class))</a></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction Fire No Fire
##    Fire      16       3
##    No Fire    1      15
##                                          
##                Accuracy : 0.8857         
##                  95% CI : (0.7326, 0.968)
##     No Information Rate : 0.5143         
##     P-Value [Acc &gt; NIR] : 3.724e-06      
##                                          
##                   Kappa : 0.772          
##                                          
##  Mcnemar&#39;s Test P-Value : 0.6171         
##                                          
##             Sensitivity : 0.9412         
##             Specificity : 0.8333         
##          Pos Pred Value : 0.8421         
##          Neg Pred Value : 0.9375         
##              Prevalence : 0.4857         
##          Detection Rate : 0.4571         
##    Detection Prevalence : 0.5429         
##       Balanced Accuracy : 0.8873         
##                                          
##        &#39;Positive&#39; Class : Fire           
## </code></pre>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb559-1" data-line-number="1"><span class="co"># Predict the model </span></a>
<a class="sourceLine" id="cb559-2" data-line-number="2">results &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">actual =</span> test_data<span class="op">$</span>Class,</a>
<a class="sourceLine" id="cb559-3" data-line-number="3">                      <span class="kw">predict</span>(model_rf, test_data, <span class="dt">type =</span> <span class="st">&quot;prob&quot;</span>))</a>
<a class="sourceLine" id="cb559-4" data-line-number="4"></a>
<a class="sourceLine" id="cb559-5" data-line-number="5"><span class="co"># rename the variables/columns</span></a>
<a class="sourceLine" id="cb559-6" data-line-number="6"><span class="kw">names</span>(results) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;actual&#39;</span>, <span class="st">&#39;Fire&#39;</span>, <span class="st">&#39;No.Fire&#39;</span>)</a>
<a class="sourceLine" id="cb559-7" data-line-number="7"></a>
<a class="sourceLine" id="cb559-8" data-line-number="8"><span class="co"># declare fire vs no fire based on probabilities</span></a>
<a class="sourceLine" id="cb559-9" data-line-number="9">results<span class="op">$</span>prediction &lt;-<span class="st"> </span><span class="kw">ifelse</span>(results<span class="op">$</span>Fire <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>, <span class="st">&quot;Fire&quot;</span>,</a>
<a class="sourceLine" id="cb559-10" data-line-number="10">                             <span class="kw">ifelse</span>(results<span class="op">$</span>No.Fire <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>, <span class="st">&quot;No Fire&quot;</span>, <span class="ot">NA</span>))</a>
<a class="sourceLine" id="cb559-11" data-line-number="11"></a>
<a class="sourceLine" id="cb559-12" data-line-number="12"><span class="co"># declare whether the model was right or wrong (true or false)</span></a>
<a class="sourceLine" id="cb559-13" data-line-number="13">results<span class="op">$</span>correct &lt;-<span class="st"> </span><span class="kw">ifelse</span>(results<span class="op">$</span>actual <span class="op">==</span><span class="st"> </span>results<span class="op">$</span>prediction, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb559-14" data-line-number="14"></a>
<a class="sourceLine" id="cb559-15" data-line-number="15"><span class="co"># plot the results</span></a>
<a class="sourceLine" id="cb559-16" data-line-number="16"><span class="kw">ggplot</span>(results, <span class="kw">aes</span>(<span class="dt">x =</span> prediction, <span class="dt">fill =</span> correct)) <span class="op">+</span></a>
<a class="sourceLine" id="cb559-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb559-18" data-line-number="18"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Random Forest Performance&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Prediction&quot;</span>)</a></code></pre></div>
<p><img src="R_Geospatial_Sciences_files/figure-html/unnamed-chunk-225-1.png" width="50%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb560-1" data-line-number="1"><span class="co"># plot thhe results using geom_jitter</span></a>
<a class="sourceLine" id="cb560-2" data-line-number="2"><span class="kw">ggplot</span>(results, <span class="kw">aes</span>(<span class="dt">x =</span> prediction, <span class="dt">y =</span> Fire, <span class="dt">color =</span> correct, <span class="dt">shape =</span> correct)) <span class="op">+</span></a>
<a class="sourceLine" id="cb560-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">alpha =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb560-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Random Forest Performance&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Prediction&quot;</span>)</a></code></pre></div>
<p><img src="R_Geospatial_Sciences_files/figure-html/unnamed-chunk-225-2.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="hyperparameter-tuning" class="section level3">
<h3><span class="header-section-number">19.3.5</span> Hyperparameter Tuning</h3>
<p>Models like the random forest model we constructed above are built based on the predictor variables. Model parameters are constructed <em>based</em> on these variables, although hyperparameters are not model parameters and they cannot be directly trained from the data. Model parameters are learned during training when we optimize a loss function. Sometimes, the construction of the architecture (i.e. format of a decision tree) may not be optimal. The act of finding the optimal model archicture is called hyperparameter tuning. We can tune our model by applying a <code>tuneGrid</code> argument with the <code>caret::train()</code> function. Our <code>tuneGrid</code> will be defined by <code>mtry</code> : The number of variables randomly sampled as candidates at each split.</p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb561-1" data-line-number="1"><span class="co"># plot the original model</span></a>
<a class="sourceLine" id="cb561-2" data-line-number="2"><span class="kw">plot</span>(model_rf)</a></code></pre></div>
<p><img src="R_Geospatial_Sciences_files/figure-html/unnamed-chunk-226-1.png" width="50%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb562-1" data-line-number="1"><span class="co"># create hyperparameter grid</span></a>
<a class="sourceLine" id="cb562-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb562-3" data-line-number="3">grid &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">mtry =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>))</a>
<a class="sourceLine" id="cb562-4" data-line-number="4"></a>
<a class="sourceLine" id="cb562-5" data-line-number="5">model_rf_tune_man &lt;-<span class="st"> </span>caret<span class="op">::</span><span class="kw">train</span>(Class <span class="op">~</span><span class="st"> </span>.,</a>
<a class="sourceLine" id="cb562-6" data-line-number="6">                         <span class="dt">data =</span> train_data,</a>
<a class="sourceLine" id="cb562-7" data-line-number="7">                         <span class="dt">method =</span> <span class="st">&quot;rf&quot;</span>,</a>
<a class="sourceLine" id="cb562-8" data-line-number="8">                         <span class="dt">preProcess =</span> <span class="kw">c</span>(<span class="st">&quot;scale&quot;</span>, <span class="st">&quot;center&quot;</span>),</a>
<a class="sourceLine" id="cb562-9" data-line-number="9">                         <span class="dt">trControl =</span> <span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, </a>
<a class="sourceLine" id="cb562-10" data-line-number="10">                                                  <span class="dt">number =</span> <span class="dv">10</span>, </a>
<a class="sourceLine" id="cb562-11" data-line-number="11">                                                  <span class="dt">repeats =</span> <span class="dv">10</span>, </a>
<a class="sourceLine" id="cb562-12" data-line-number="12">                                                  <span class="dt">savePredictions =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb562-13" data-line-number="13">                                                  <span class="dt">verboseIter =</span> <span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb562-14" data-line-number="14">                         <span class="dt">tuneGrid =</span> grid)</a>
<a class="sourceLine" id="cb562-15" data-line-number="15"></a>
<a class="sourceLine" id="cb562-16" data-line-number="16">model_rf_tune_man</a></code></pre></div>
<pre><code>## Random Forest 
## 
## 87 samples
##  4 predictor
##  2 classes: &#39;Fire&#39;, &#39;No Fire&#39; 
## 
## Pre-processing: scaled (4), centered (4) 
## Resampling: Cross-Validated (10 fold, repeated 10 times) 
## Summary of sample sizes: 78, 78, 79, 79, 77, 79, ... 
## Resampling results across tuning parameters:
## 
##   mtry  Accuracy   Kappa    
##    1    0.8350278  0.6714680
##    2    0.8176667  0.6355919
##    3    0.8154722  0.6311586
##    4    0.8114167  0.6214337
##    5    0.8171389  0.6328296
##    6    0.8147778  0.6282390
##    7    0.8139167  0.6264313
##    8    0.8135278  0.6255191
##    9    0.8161389  0.6308268
##   10    0.8158889  0.6305575
## 
## Accuracy was used to select the optimal model using the largest value.
## The final value used for the model was mtry = 1.</code></pre>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb564-1" data-line-number="1"><span class="kw">plot</span>(model_rf_tune_man)</a></code></pre></div>
<p><img src="R_Geospatial_Sciences_files/figure-html/unnamed-chunk-226-2.png" width="50%" style="display: block; margin: auto;" /></p>
<p>Notice hoe many more predictors we get. Our dataset is not the best example for this practice because our dataset only has a handful of predictors. However, The search of the <code>tuneGrid</code> function above is not random by default. Let’s perform a random search of the tuning parmaeters and provide a <code>tuneLength</code> - An integer denoting the amount of granularity in the tuning parameter grid.</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb565-1" data-line-number="1">model_rf_tune_auto &lt;-<span class="st"> </span>caret<span class="op">::</span><span class="kw">train</span>(Class <span class="op">~</span><span class="st"> </span>.,</a>
<a class="sourceLine" id="cb565-2" data-line-number="2">                         <span class="dt">data =</span> train_data,</a>
<a class="sourceLine" id="cb565-3" data-line-number="3">                         <span class="dt">method =</span> <span class="st">&quot;rf&quot;</span>,</a>
<a class="sourceLine" id="cb565-4" data-line-number="4">                         <span class="dt">preProcess =</span> <span class="kw">c</span>(<span class="st">&quot;scale&quot;</span>, <span class="st">&quot;center&quot;</span>),</a>
<a class="sourceLine" id="cb565-5" data-line-number="5">                         <span class="dt">trControl =</span> <span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, </a>
<a class="sourceLine" id="cb565-6" data-line-number="6">                                                  <span class="dt">number =</span> <span class="dv">10</span>, </a>
<a class="sourceLine" id="cb565-7" data-line-number="7">                                                  <span class="dt">repeats =</span> <span class="dv">10</span>, </a>
<a class="sourceLine" id="cb565-8" data-line-number="8">                                                  <span class="dt">savePredictions =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb565-9" data-line-number="9">                                                  <span class="dt">verboseIter =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb565-10" data-line-number="10">                                                  <span class="dt">search =</span> <span class="st">&quot;random&quot;</span>),</a>
<a class="sourceLine" id="cb565-11" data-line-number="11">                         <span class="dt">tuneGrid =</span> grid,</a>
<a class="sourceLine" id="cb565-12" data-line-number="12">                         <span class="dt">tuneLength =</span> <span class="dv">15</span>)</a>
<a class="sourceLine" id="cb565-13" data-line-number="13">model_rf_tune_auto</a></code></pre></div>
<pre><code>## Random Forest 
## 
## 87 samples
##  4 predictor
##  2 classes: &#39;Fire&#39;, &#39;No Fire&#39; 
## 
## Pre-processing: scaled (4), centered (4) 
## Resampling: Cross-Validated (10 fold, repeated 10 times) 
## Summary of sample sizes: 78, 79, 78, 77, 79, 79, ... 
## Resampling results across tuning parameters:
## 
##   mtry  Accuracy   Kappa    
##    1    0.8441111  0.6903933
##    2    0.8262778  0.6533746
##    3    0.8163333  0.6317828
##    4    0.8173611  0.6326702
##    5    0.8152500  0.6288156
##    6    0.8196111  0.6372856
##    7    0.8127778  0.6232523
##    8    0.8197222  0.6372499
##    9    0.8161389  0.6300520
##   10    0.8137500  0.6254779
## 
## Accuracy was used to select the optimal model using the largest value.
## The final value used for the model was mtry = 1.</code></pre>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb567-1" data-line-number="1"><span class="kw">plot</span>(model_rf_tune_auto)</a></code></pre></div>
<p><img src="R_Geospatial_Sciences_files/figure-html/unnamed-chunk-227-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>As we see above, random forest models can quickly become complex due to the fact that there’s uncertainty in any classification prediction. A particular model can require tuning as seen above. Once again, this practice is much more useful for a dataset with more predictors but it’s important to show how it can be done here.</p>
</div>
</div>
<div id="assignment-11" class="section level2">
<h2><span class="header-section-number">19.4</span> Assignment</h2>
<p>Perform the exact same analysis for the <code>SidiBel_ForestFires.csv</code> dataset (this has the same variables as <code>Bejaia_ForestFires.csv</code>). Proceed with the same workflow and create the same plots. Add plots to a document (Word, Google Docs, or RMarkdown file, your choice).</p>
<p><strong>Upload file (as word doc, PDF, whatever works) to UD Canvas.</strong></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="time-series-forecasting.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
